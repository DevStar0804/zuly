{"remainingRequest":"D:\\working\\Vue\\zuly\\node_modules\\babel-loader\\lib\\index.js!D:\\working\\Vue\\zuly\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\working\\Vue\\zuly\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\working\\Vue\\zuly\\src\\pages\\Contact.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\working\\Vue\\zuly\\src\\pages\\Contact.vue","mtime":1603842703509},{"path":"D:\\working\\Vue\\zuly\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1601629561006},{"path":"D:\\working\\Vue\\zuly\\node_modules\\babel-loader\\lib\\index.js","mtime":1599704251701},{"path":"D:\\working\\Vue\\zuly\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1601629561006},{"path":"D:\\working\\Vue\\zuly\\node_modules\\vue-loader\\lib\\index.js","mtime":1601629564332}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IFZ1ZSBmcm9tICd2dWUnOwppbXBvcnQgJ3Z1ZS10b2FzdC1ub3RpZmljYXRpb24vZGlzdC90aGVtZS1kZWZhdWx0LmNzcyc7CmV4cG9ydCBkZWZhdWx0IHsKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgcHVibGljUGF0aDogcHJvY2Vzcy5lbnYuQkFTRV9VUkwsCiAgICAgIGNvbnRhY3RfaWQ6IG51bGwsCiAgICAgIGNvbnRhY3Q6IHt9LAogICAgICBjb250YWN0czogW10sCiAgICAgIGluZGV4OiAnJywKICAgICAgdG90YWw6ICcnLAogICAgICBmcmVlemU6IHRydWUKICAgIH07CiAgfSwKCiAgYmVmb3JlUm91dGVVcGRhdGUodG8sIGZyb20sIG5leHQpIHsKICAgIGNvbnNvbGUubG9nKCdiZWZvcmVSb3V0ZVVwZGF0ZScpOwogICAgdGhpcy5mcmVlemUgPSB0cnVlOwogICAgdGhpcy5sb2FkKHRvLCBuZXh0KTsKICB9LAoKICB3YXRjaDogewogICAgY29udGFjdDogewogICAgICBoYW5kbGVyKHZhbCkgewogICAgICAgIGlmICghdGhpcy5mcmVlemUpIHsKICAgICAgICAgIHRoaXMuZnJlZXplID0gdHJ1ZTsKICAgICAgICAgIGNvbnNvbGUubG9nKCdQVVQgPSAnLCB0aGlzLmNvbnRhY3QpOwogICAgICAgICAgdGhpcy5wdXRDb250YWN0KCkudGhlbihkYXRhID0+IHsKICAgICAgICAgICAgdGhpcy5mcmVlemUgPSBmYWxzZTsKICAgICAgICAgICAgVnVlLiR0b2FzdC5vcGVuKHsKICAgICAgICAgICAgICBtZXNzYWdlOiAnUmljaGllc3RhIGFnZ2lvcm5hdGEnLAogICAgICAgICAgICAgIHR5cGU6ICdzdWNjZXNzJywKICAgICAgICAgICAgICBwb3NpdGlvbjogJ3RvcC1sZWZ0JwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSwKCiAgICAgIGRlZXA6IHRydWUKICAgIH0KICB9LAogIGNvbXB1dGVkOiB7CiAgICBwcmV2aW91czogZnVuY3Rpb24gKCkgewogICAgICBpZiAodGhpcy5pbmRleCA+IDApIHsKICAgICAgICByZXR1cm4gdGhpcy5jb250YWN0c1t0aGlzLmluZGV4IC0gMV07CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KICAgIH0sCiAgICBuZXh0OiBmdW5jdGlvbiAoKSB7CiAgICAgIGlmICh0aGlzLmluZGV4ICsgMSA8IHRoaXMudG90YWwpIHsKICAgICAgICByZXR1cm4gdGhpcy5jb250YWN0c1t0aGlzLmluZGV4ICsgMV07CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KICAgIH0KICB9LAogIG1ldGhvZHM6IHsKICAgIGFzeW5jIGZldGNoQ29udGFjdCgpIHsKICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCgnL2FwaS9jb250YWN0cy8nICsgdGhpcy5jb250YWN0X2lkLCB7CiAgICAgICAgbW9kZTogJ25vLWNvcnMnLAogICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICdhY2NlcHQnOiAnYXBwbGljYXRpb24vanNvbicKICAgICAgICB9CiAgICAgIH0pOwogICAgICByZXR1cm4gcmVzcG9uc2UuanNvbigpOwogICAgfSwKCiAgICBhc3luYyBwdXRDb250YWN0KCkgewogICAgICBsZXQgcGF5bG9hZCA9IHRoaXMuY29udGFjdDsKICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCgnL2FwaS9zdG9yZXMvJyArIHRoaXMuY29udGFjdC5zdG9yZV9pZCArICcvY29udGFjdHMvJyArIHRoaXMuY29udGFjdF9pZCwgewogICAgICAgIG1ldGhvZDogJ1BVVCcsCiAgICAgICAgaGVhZGVyczogewogICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJywKICAgICAgICAgICdhY2NlcHQnOiAnYXBwbGljYXRpb24vanNvbicKICAgICAgICB9LAogICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHBheWxvYWQpCiAgICAgIH0pOwogICAgICByZXR1cm4gcmVzcG9uc2UuanNvbigpOwogICAgfSwKCiAgICBsb2FkKHRvLCBjYWxsYmFjaykgewogICAgICB0aGlzLmNvbnRhY3RfaWQgPSB0by5wYXJhbXMuY29udGFjdF9pZDsKICAgICAgbGV0IHNlbGYgPSB0aGlzOwogICAgICBzZWxmLmZldGNoQ29udGFjdCgpLnRoZW4oZGF0YSA9PiB7CiAgICAgICAgc2VsZi5jb250YWN0cyA9IGRhdGEuY29udGFjdHM7CiAgICAgICAgc2VsZi5jb250YWN0ID0gZGF0YS5jb250YWN0OwogICAgICAgIHNlbGYudG90YWwgPSBkYXRhLmNvbnRhY3RzLmxlbmd0aDsKICAgICAgICBzZWxmLmluZGV4ID0gZGF0YS5jb250YWN0cy5maW5kSW5kZXgoYyA9PiB7CiAgICAgICAgICByZXR1cm4gYyA9PT0gc2VsZi5jb250YWN0X2lkOwogICAgICAgIH0pOwogICAgICAgIFZ1ZS5uZXh0VGljaygoKSA9PiB7CiAgICAgICAgICBzZWxmLmZyZWV6ZSA9IGZhbHNlOwogICAgICAgIH0pOwoKICAgICAgICBpZiAoY2FsbGJhY2spIHsKICAgICAgICAgIGNhbGxiYWNrKCk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KCiAgfSwKICBtb3VudGVkOiBmdW5jdGlvbiAoKSB7CiAgICB0aGlzLmxvYWQodGhpcy4kcm91dGUpOwogIH0KfTs="},{"version":3,"sources":["Contact.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmDA,OAAA,GAAA,MAAA,KAAA;AACA,OAAA,+CAAA;AAEA,eAAA;AACA,EAAA,IAAA,GAAA;AACA,WAAA;AACA,MAAA,UAAA,EAAA,OAAA,CAAA,GAAA,CAAA,QADA;AAEA,MAAA,UAAA,EAAA,IAFA;AAGA,MAAA,OAAA,EAAA,EAHA;AAIA,MAAA,QAAA,EAAA,EAJA;AAKA,MAAA,KAAA,EAAA,EALA;AAMA,MAAA,KAAA,EAAA,EANA;AAOA,MAAA,MAAA,EAAA;AAPA,KAAA;AASA,GAXA;;AAYA,EAAA,iBAAA,CAAA,EAAA,EAAA,IAAA,EAAA,IAAA,EAAA;AACA,IAAA,OAAA,CAAA,GAAA,CAAA,mBAAA;AACA,SAAA,MAAA,GAAA,IAAA;AACA,SAAA,IAAA,CAAA,EAAA,EAAA,IAAA;AACA,GAhBA;;AAiBA,EAAA,KAAA,EAAA;AACA,IAAA,OAAA,EAAA;AACA,MAAA,OAAA,CAAA,GAAA,EAAA;AACA,YAAA,CAAA,KAAA,MAAA,EAAA;AACA,eAAA,MAAA,GAAA,IAAA;AACA,UAAA,OAAA,CAAA,GAAA,CAAA,QAAA,EAAA,KAAA,OAAA;AACA,eAAA,UAAA,GAAA,IAAA,CAAA,IAAA,IAAA;AACA,iBAAA,MAAA,GAAA,KAAA;AACA,YAAA,GAAA,CAAA,MAAA,CAAA,IAAA,CACA;AACA,cAAA,OAAA,EAAA,sBADA;AAEA,cAAA,IAAA,EAAA,SAFA;AAGA,cAAA,QAAA,EAAA;AAHA,aADA;AAOA,WATA;AAWA;AACA,OAjBA;;AAkBA,MAAA,IAAA,EAAA;AAlBA;AADA,GAjBA;AAuCA,EAAA,QAAA,EAAA;AACA,IAAA,QAAA,EAAA,YAAA;AACA,UAAA,KAAA,KAAA,GAAA,CAAA,EAAA;AACA,eAAA,KAAA,QAAA,CAAA,KAAA,KAAA,GAAA,CAAA,CAAA;AACA,OAFA,MAEA;AACA,eAAA,IAAA;AACA;AACA,KAPA;AAQA,IAAA,IAAA,EAAA,YAAA;AACA,UAAA,KAAA,KAAA,GAAA,CAAA,GAAA,KAAA,KAAA,EAAA;AACA,eAAA,KAAA,QAAA,CAAA,KAAA,KAAA,GAAA,CAAA,CAAA;AACA,OAFA,MAEA;AACA,eAAA,IAAA;AACA;AACA;AAdA,GAvCA;AAuDA,EAAA,OAAA,EAAA;AACA,UAAA,YAAA,GAAA;AACA,YAAA,QAAA,GAAA,MAAA,KAAA,CAAA,mBAAA,KAAA,UAAA,EAAA;AACA,QAAA,IAAA,EAAA,SADA;AAEA,QAAA,OAAA,EAAA;AACA,oBAAA;AADA;AAFA,OAAA,CAAA;AAOA,aAAA,QAAA,CAAA,IAAA,EAAA;AACA,KAVA;;AAWA,UAAA,UAAA,GAAA;AACA,UAAA,OAAA,GAAA,KAAA,OAAA;AACA,YAAA,QAAA,GAAA,MAAA,KAAA,CAAA,iBAAA,KAAA,OAAA,CAAA,QAAA,GAAA,YAAA,GAAA,KAAA,UAAA,EAAA;AACA,QAAA,MAAA,EAAA,KADA;AAEA,QAAA,OAAA,EAAA;AACA,0BAAA,kBADA;AAEA,oBAAA;AAFA,SAFA;AAMA,QAAA,IAAA,EAAA,IAAA,CAAA,SAAA,CAAA,OAAA;AANA,OAAA,CAAA;AASA,aAAA,QAAA,CAAA,IAAA,EAAA;AACA,KAvBA;;AAwBA,IAAA,IAAA,CAAA,EAAA,EAAA,QAAA,EAAA;AACA,WAAA,UAAA,GAAA,EAAA,CAAA,MAAA,CAAA,UAAA;AACA,UAAA,IAAA,GAAA,IAAA;AACA,MAAA,IAAA,CAAA,YAAA,GAAA,IAAA,CAAA,IAAA,IAAA;AACA,QAAA,IAAA,CAAA,QAAA,GAAA,IAAA,CAAA,QAAA;AACA,QAAA,IAAA,CAAA,OAAA,GAAA,IAAA,CAAA,OAAA;AACA,QAAA,IAAA,CAAA,KAAA,GAAA,IAAA,CAAA,QAAA,CAAA,MAAA;AACA,QAAA,IAAA,CAAA,KAAA,GAAA,IAAA,CAAA,QAAA,CAAA,SAAA,CAAA,CAAA,IAAA;AAAA,iBAAA,CAAA,KAAA,IAAA,CAAA,UAAA;AAAA,SAAA,CAAA;AACA,QAAA,GAAA,CAAA,QAAA,CAAA,MAAA;AACA,UAAA,IAAA,CAAA,MAAA,GAAA,KAAA;AACA,SAFA;;AAGA,YAAA,QAAA,EAAA;AAAA,UAAA,QAAA;AAAA;AACA,OATA;AAUA;;AArCA,GAvDA;AA8FA,EAAA,OAAA,EAAA,YAAA;AACA,SAAA,IAAA,CAAA,KAAA,MAAA;AACA;AAhGA,CAAA","sourcesContent":["<template>\r\n  <div class=\"container mt-3\">\r\n    <small class=\"text-muted\">{{ $options.__file }}</small>\r\n    <h1 class=\"text-primary font-weight-bold\">\r\n      <router-link to=\"/contacts\"><img src=\"~bootstrap-icons/icons/caret-left-fill.svg\" alt=\"caret icon\" width=\"30\" height=\"30\"></router-link>\r\n      Contatto {{ index + 1 }} di {{ total }} per {{ contact.store_id }}\r\n      <router-link tag=\"button\" :disabled=\"!previous\" class=\"btn btn-secondary btn-sm mt-3 mb-3\" :to=\"'/contact/' + previous\" role=\"button\">precedente</router-link>\r\n      <router-link tag=\"button\" :disabled=\"!next\" class=\"btn btn-secondary btn-sm mt-3 mb-3\" :to=\"'/contact/' + next\" role=\"button\">prossimo</router-link>\r\n    </h1>\r\n    <ul class=\"list-group\">\r\n      <li class=\"list-group-item list-group-item-dark\">Nome</li>\r\n      <li class=\"list-group-item list-group-item-light\">\r\n        <input name=\"fname\" autocomplete=\"given-name\" type=\"text\" class=\"px-3 py-1 w-100 rounded mb-2\" v-model.lazy=\"contact.name\" />\r\n      </li>\r\n      <li class=\"list-group-item list-group-item-dark\">Data</li>\r\n      <li class=\"list-group-item list-group-item-light\">{{ contact.mtime }}</li>\r\n      <li class=\"list-group-item list-group-item-dark\">Richiesta</li>\r\n      <li class=\"list-group-item list-group-item-light\">\r\n        <textarea class=\"rounded px-3 py-2 mb-2 w-100\" v-model.lazy=\"contact.request\"></textarea>\r\n      </li>\r\n      <li class=\"list-group-item list-group-item-dark\">Numero di telefono</li>\r\n      <li class=\"list-group-item list-group-item-light\">\r\n        <input name=\"mobile\" autocomplete=\"tel\" type=\"number\" class=\"px-3 py-1 w-100 rounded mb-2\" v-model.lazy=\"contact.telephone_number\" />\r\n        <a class=\"btn btn-secondary rounded-circle\" href=\"#\" role=\"button\" data-title=\"Chiama col telefono\"><img src=\"~bootstrap-icons/icons/telephone-outbound.svg\" alt=\"phone icon\" width=\"30\" height=\"30\"></a>\r\n        <a  data-title=\"Chiama con WhatsApp\" class=\"\" href=\"#\" role=\"button\"><img :src=\"publicPath + 'WhatsApp.svg'\" alt=\"whatsapp icon\" width=\"60\" height=\"60\"></a>\r\n      </li>\r\n      <li class=\"list-group-item list-group-item-dark\">Email</li>\r\n      <li class=\"list-group-item list-group-item-light\">\r\n        <input name=\"email\" autocomplete=\"email\" type=\"email\" class=\"px-3 py-1 w-100 rounded mb-2\" v-model.lazy=\"contact.email\" />\r\n      </li>\r\n      <li class=\"list-group-item list-group-item-dark\">Preferenze di contatto</li>\r\n      <li class=\"list-group-item list-group-item-light\">\r\n        <input type=\"text\" class=\"px-3 py-1 w-100 rounded mb-2\" v-model.lazy=\"contact.preference\" />\r\n      </li>\r\n    </ul>\r\n    <div class=\"btn-group\" role=\"group\" aria-label=\"Comandi sui contatti\">\r\n      <router-link tag=\"button\" class=\"btn btn-secondary btn-lg mt-3 mb-3\" :to=\"'/store/' + contact.store_id + '/live/' + contact_id\" role=\"button\"><img src=\"~bootstrap-icons/icons/camera-reels.svg\" alt=\"phone icon\" width=\"30\" height=\"30\"> Avvia il live-streaming</router-link>\r\n      <button type=\"button\" class=\"btn btn-secondary btn-lg mt-3 mb-3\" v-on:click=\"contact.dismissed = !contact.dismissed\">\r\n        <span v-if=\"contact.dismissed\">\r\n          Segna come da leggere\r\n        </span>\r\n        <span v-else>\r\n          Segna come letto\r\n        </span>\r\n      </button>\r\n      <button disabled type=\"button\" class=\"btn btn-secondary btn-lg mt-3 mb-3\">Proposta di acquisto</button>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport Vue from 'vue'\r\nimport 'vue-toast-notification/dist/theme-default.css'\r\n\r\nexport default {\r\n  data () {\r\n    return {\r\n      publicPath: process.env.BASE_URL,\r\n      contact_id: null,\r\n      contact: { },\r\n      contacts: [],\r\n      index: '',\r\n      total: '',\r\n      freeze: true\r\n    }\r\n  },\r\n  beforeRouteUpdate (to, from, next) {\r\n    console.log('beforeRouteUpdate')\r\n    this.freeze = true\r\n    this.load(to, next)\r\n  },\r\n  watch: {\r\n    contact: {\r\n      handler (val) {\r\n        if (!this.freeze) {\r\n          this.freeze = true\r\n          console.log('PUT = ', this.contact)\r\n          this.putContact().then(data => {\r\n            this.freeze = false\r\n            Vue.$toast.open(\r\n              {\r\n                message: 'Richiesta aggiornata',\r\n                type: 'success',\r\n                position: 'top-left'\r\n              }\r\n            )\r\n          }\r\n          )\r\n        }\r\n      },\r\n      deep: true\r\n    }\r\n  },\r\n  computed: {\r\n    previous: function () {\r\n      if (this.index > 0) {\r\n        return this.contacts[this.index - 1]\r\n      } else {\r\n        return null\r\n      }\r\n    },\r\n    next: function () {\r\n      if (this.index + 1 < this.total) {\r\n        return this.contacts[this.index + 1]\r\n      } else {\r\n        return null\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    async fetchContact () {\r\n      const response = await fetch('/api/contacts/' + this.contact_id, {\r\n        mode: 'no-cors',\r\n        headers: {\r\n          'accept': 'application/json'\r\n        }\r\n      }\r\n      )\r\n      return response.json()\r\n    },\r\n    async putContact () {\r\n      let payload = this.contact\r\n      const response = await fetch('/api/stores/' + this.contact.store_id + '/contacts/' + this.contact_id, {\r\n        method: 'PUT',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          'accept': 'application/json'\r\n        },\r\n        body: JSON.stringify(payload)\r\n      }\r\n      )\r\n      return response.json()\r\n    },\r\n    load (to, callback) {\r\n      this.contact_id = to.params.contact_id\r\n      let self = this\r\n      self.fetchContact().then(data => {\r\n        self.contacts = data.contacts\r\n        self.contact = data.contact\r\n        self.total = data.contacts.length\r\n        self.index = data.contacts.findIndex((c) => { return c === self.contact_id })\r\n        Vue.nextTick(() => {\r\n          self.freeze = false\r\n        })\r\n        if (callback) { callback() }\r\n      })\r\n    }\r\n  },\r\n  mounted: function () {\r\n    this.load(this.$route)\r\n  }\r\n}\r\n</script>\n"],"sourceRoot":"src/pages"}]}