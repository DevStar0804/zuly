{"remainingRequest":"D:\\working\\Vue\\zuly\\zuly\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\working\\Vue\\zuly\\zuly\\src\\pages\\Store.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\working\\Vue\\zuly\\zuly\\src\\pages\\Store.vue","mtime":1604333533701},{"path":"D:\\working\\Vue\\zuly\\zuly\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\working\\Vue\\zuly\\zuly\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\working\\Vue\\zuly\\zuly\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\working\\Vue\\zuly\\zuly\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBWdWUgZnJvbSAndnVlJwppbXBvcnQgeyBFZGl0b3IsIEVkaXRvckNvbnRlbnQsIEVkaXRvck1lbnVCYXIsIEVkaXRvck1lbnVCdWJibGUgfSBmcm9tICd0aXB0YXAnCmltcG9ydCB7CiAgQmxvY2txdW90ZSwKICBCdWxsZXRMaXN0LAogIENvZGVCbG9jaywKICBIYXJkQnJlYWssCiAgSGVhZGluZywKICBIb3Jpem9udGFsUnVsZSwKICBMaXN0SXRlbSwKICBPcmRlcmVkTGlzdCwKICBUb2RvSXRlbSwKICBUb2RvTGlzdCwKICBCb2xkLAogIENvZGUsCiAgSXRhbGljLAogIExpbmssCiAgU3RyaWtlLAogIFVuZGVybGluZSwKICBIaXN0b3J5Cn0gZnJvbSAndGlwdGFwLWV4dGVuc2lvbnMnCmltcG9ydCAnbGVhZmxldC9kaXN0L2xlYWZsZXQuY3NzJwppbXBvcnQgJy4uLy4uL3B1YmxpYy9tZW51YmFyLnNjc3MnCmltcG9ydCAnLi4vLi4vcHVibGljL21lbnVidWJibGUuc2NzcycKaW1wb3J0ICd2dWUtdG9hc3Qtbm90aWZpY2F0aW9uL2Rpc3QvdGhlbWUtZGVmYXVsdC5jc3MnCmltcG9ydCBMIGZyb20gJ2xlYWZsZXQnCmNvbnN0IFNUQVRVU19JTklUSUFMID0gMApjb25zdCBTVEFUVVNfU0FWSU5HID0gMQpjb25zdCBTVEFUVVNfU1VDQ0VTUyA9IDIKY29uc3QgU1RBVFVTX0ZBSUxFRCA9IDMKZXhwb3J0IGRlZmF1bHQgewogIGNvbXBvbmVudHM6IHsKICAgIEVkaXRvckNvbnRlbnQsCiAgICBFZGl0b3JNZW51QmFyLAogICAgRWRpdG9yTWVudUJ1YmJsZQogIH0sCiAgZGF0YSAoKSB7CiAgICByZXR1cm4gewogICAgICBzdG9yZV9pZDogJycsCiAgICAgIHN0b3JlOiB7fSwKICAgICAgZWRpdG9yOiBuZXcgRWRpdG9yKHsKICAgICAgICBvbkJsdXI6ICh7IGV2ZW50IH0pID0+IHsKICAgICAgICAgIHRoaXMuVXBkYXRlQ29tcGFueShldmVudCkKICAgICAgICB9LAogICAgICAgIGV4dGVuc2lvbnM6IFsKICAgICAgICAgIG5ldyBCbG9ja3F1b3RlKCksCiAgICAgICAgICBuZXcgQnVsbGV0TGlzdCgpLAogICAgICAgICAgbmV3IENvZGVCbG9jaygpLAogICAgICAgICAgbmV3IEhhcmRCcmVhaygpLAogICAgICAgICAgbmV3IEhlYWRpbmcoeyBsZXZlbHM6IFsxLCAyLCAzXSB9KSwKICAgICAgICAgIG5ldyBIb3Jpem9udGFsUnVsZSgpLAogICAgICAgICAgbmV3IExpc3RJdGVtKCksCiAgICAgICAgICBuZXcgT3JkZXJlZExpc3QoKSwKICAgICAgICAgIG5ldyBUb2RvSXRlbSh7CiAgICAgICAgICAgIG5lc3RlZDogdHJ1ZQogICAgICAgICAgfSksCiAgICAgICAgICBuZXcgVG9kb0xpc3QoKSwKICAgICAgICAgIG5ldyBMaW5rKCksCiAgICAgICAgICBuZXcgQm9sZCgpLAogICAgICAgICAgbmV3IENvZGUoKSwKICAgICAgICAgIG5ldyBJdGFsaWMoKSwKICAgICAgICAgIG5ldyBTdHJpa2UoKSwKICAgICAgICAgIG5ldyBVbmRlcmxpbmUoKSwKICAgICAgICAgIG5ldyBIaXN0b3J5KCkKICAgICAgICBdLAogICAgICAgIGNvbnRlbnQ6ICcnCiAgICAgIH0pLAogICAgICBDdXJyZW50Q2F0ZWdvcmllczogW10sCiAgICAgIENhdGVnb3JpZXM6IFtdLAogICAgICBjdXJyZW50Y2F0ZWdvcnk6ICcnLAogICAgICBjYXRlZ29yeWltZzogJycsCiAgICAgIEltZ1VybHM6IFtdLAogICAgICBkZWxldGVpbWc6ICcnLAogICAgICBjb21wYW55X25hbWU6ICcnLAogICAgICBkZXNjcmlwdGlvbl9sZW5ndGg6IDAsCiAgICAgIGxhdGl0dWRlOiA0My44NzkwNTE4Mjg0NDA2OSwKICAgICAgbG9uZ2l0dWRlOiAxMS4xMDIzMjgzMDA0NzYwNzYsCiAgICAgIHB1YmxpY1BhdGg6IHByb2Nlc3MuZW52LkJBU0VfVVJMLAogICAgICBzaG93X21hcDogZmFsc2UsCiAgICAgIEN1cnJlbnRMaW5rczogW10sCiAgICAgIExpbmtzOiBbXSwKICAgICAgYWRkbGluazogJycsCiAgICAgIGFkZGxpbmt1cmw6ICcnLAogICAgICB1cGxvYWRlZEZpbGVzOiBbXSwKICAgICAgdXBsb2FkRXJyb3I6IG51bGwsCiAgICAgIGN1cnJlbnRTdGF0dXM6IG51bGwsCiAgICAgIHVwbG9hZEZpZWxkTmFtZTogJ2NvbnRlbnRzJywKICAgICAgb3BlbndlZWs6ICdzZWxlY3RlZCcsCiAgICAgIGxpdmV3ZWVrOiAnc2VsZWN0ZWQnLAogICAgICBPcGVuaW5nSG91cnM6IFtdLAogICAgICBDdXJyZW50T3BlbmluZ0hvdXJzOiB7fSwKICAgICAgQ3VycmVudExpdmVTdHJlYW1pbmc6IHt9LAogICAgICBMaXZlU3RyZWFtaW5nOiBbXSwKICAgICAgbGlua1VybDogbnVsbCwKICAgICAgbGlua01lbnVJc0FjdGl2ZTogZmFsc2UsCiAgICAgIGxvZ29faWQ6ICcnLAogICAgfQogIH0sCiAgYmVmb3JlRGVzdHJveSAoKSB7CiAgICB0aGlzLmVkaXRvci5kZXN0cm95KCkKICB9LAogIHdhdGNoOiB7CiAgICBDdXJyZW50T3BlbmluZ0hvdXJzICgpIHsKICAgICAgcmV0dXJuIHRoaXMuQ3VycmVudE9wZW5pbmdIb3VycwogICAgfSwKICAgIG9wZW53ZWVrOiBmdW5jdGlvbiAoKSB7CiAgICAgIGxldCBmbGFnID0gdHJ1ZQogICAgICBmb3IgKGxldCBpIGluIHRoaXMuQ3VycmVudE9wZW5pbmdIb3VycykgewogICAgICAgIGlmIChpID09PSB0aGlzLm9wZW53ZWVrKSB7CiAgICAgICAgICBmbGFnID0gZmFsc2UKICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKGZsYWcpIHsKICAgICAgICBpZiAodGhpcy5vcGVud2VlayAhPT0gJ3NlbGVjdGVkJykgewogICAgICAgICAgdGhpcy5DdXJyZW50T3BlbmluZ0hvdXJzW3RoaXMub3BlbndlZWtdID0gW10KICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBsaXZld2VlazogZnVuY3Rpb24gKCkgewogICAgICBsZXQgZmxhZyA9IHRydWUKICAgICAgZm9yIChsZXQgaSBpbiB0aGlzLkN1cnJlbnRMaXZlU3RyZWFtaW5nKSB7CiAgICAgICAgaWYgKGkgPT09IHRoaXMubGl2ZXdlZWspIHsKICAgICAgICAgIGZsYWcgPSBmYWxzZQogICAgICAgIH0KICAgICAgfQogICAgICBpZiAoZmxhZykgewogICAgICAgIGlmICh0aGlzLmxpdmV3ZWVrICE9PSAnc2VsZWN0ZWQnKSB7CiAgICAgICAgICB0aGlzLkN1cnJlbnRMaXZlU3RyZWFtaW5nW3RoaXMubGl2ZXdlZWtdID0gW10KICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBhZGRsaW5rdXJsOiBmdW5jdGlvbiAoKSB7CiAgICAgIHRoaXMuQWRkTGluaygpLnRoZW4oKGRhdGEpID0+IHsKICAgICAgICBpZiAoZGF0YSkgewogICAgICAgICAgdGhpcy5MaW5rcy5mb3JFYWNoKChsaW5rKSA9PiB7CiAgICAgICAgICAgIGlmICh0aGlzLmFkZGxpbmsgPT09IGxpbmsuaWQpIHsKICAgICAgICAgICAgICB0aGlzLkN1cnJlbnRMaW5rcy5wdXNoKHsKICAgICAgICAgICAgICAgIGlkOiBkYXRhLmlkLAogICAgICAgICAgICAgICAgbGlua19pZDogbGluay5pZCwKICAgICAgICAgICAgICAgIGRpc3BsYXk6IGxpbmsuZGlzcGxheSwKICAgICAgICAgICAgICAgIGltYWdlOiBsaW5rLmltYWdlLAogICAgICAgICAgICAgICAgdXJsOiB0aGlzLmFkZGxpbmt1cmwKICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgIFZ1ZS4kdG9hc3Qub3Blbih7CiAgICAgICAgICAgICAgICBtZXNzYWdlOiAnQWdnaXVudG8gY29uIHN1Y2Nlc3NvIScsCiAgICAgICAgICAgICAgICB0eXBlOiAnc3VjY2VzcycsCiAgICAgICAgICAgICAgICBwb3NpdGlvbjogJ3RvcC1sZWZ0JwogICAgICAgICAgICAgIH0pCiAgICAgICAgICAgIH0KICAgICAgICAgIH0pCiAgICAgICAgfQogICAgICB9KQogICAgfQogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIGlzSW5pdGlhbCAoKSB7CiAgICAgIHJldHVybiB0aGlzLmN1cnJlbnRTdGF0dXMgPT09IFNUQVRVU19JTklUSUFMCiAgICB9LAogICAgaXNTYXZpbmcgKCkgewogICAgICByZXR1cm4gdGhpcy5jdXJyZW50U3RhdHVzID09PSBTVEFUVVNfU0FWSU5HCiAgICB9LAogICAgaXNTdWNjZXNzICgpIHsKICAgICAgcmV0dXJuIHRoaXMuY3VycmVudFN0YXR1cyA9PT0gU1RBVFVTX1NVQ0NFU1MKICAgIH0sCiAgICBpc0ZhaWxlZCAoKSB7CiAgICAgIHJldHVybiB0aGlzLmN1cnJlbnRTdGF0dXMgPT09IFNUQVRVU19GQUlMRUQKICAgIH0KICB9LAogIG1ldGhvZHM6IHsKICAgIG1haW5jYXRlZ29yeSAobWFpbmNhdGVnb3J5KSB7CiAgICAgIHRoaXMuTWFpbkNhdGVnb3J5KG1haW5jYXRlZ29yeSkudGhlbigoZGF0YSkgPT4gewogICAgICAgIGlmIChkYXRhLnN0YXR1cyA9PT0gMjAwKSB7CiAgICAgICAgICB0aGlzLkN1cnJlbnRDYXRlZ29yaWVzLmZvckVhY2goKGNhdGVnb3J5KSA9PiB7CiAgICAgICAgICAgIGlmIChjYXRlZ29yeS52YWx1ZSA9PT0gbWFpbmNhdGVnb3J5KSBjYXRlZ29yeS5zdGFyID0gJ2ZpbGxlZCcKICAgICAgICAgICAgZWxzZSBjYXRlZ29yeS5zdGFyID0gJ3VuZmlsbGVkJwogICAgICAgICAgfSkKICAgICAgICAgIFZ1ZS4kdG9hc3Qub3Blbih7CiAgICAgICAgICAgIG1lc3NhZ2U6ICdTZWxlemlvbmF0byBjb24gc3VjY2Vzc28gY29tZSBjYXRlZ29yaWEgcHJpbmNpcGFsZSEnLAogICAgICAgICAgICB0eXBlOiAnc3VjY2VzcycsCiAgICAgICAgICAgIHBvc2l0aW9uOiAndG9wLWxlZnQnCiAgICAgICAgICB9KQogICAgICAgIH0KICAgICAgfSkKICAgIH0sCiAgICBhZGRjYXRlZ29yeSAoYWRkY2F0ZWdvcnkpIHsKICAgICAgbGV0IGZsYWcgPSB0cnVlCiAgICAgIHRoaXMuQ3VycmVudENhdGVnb3JpZXMuZm9yRWFjaCgoY2F0ZWdvcnkpID0+IHsKICAgICAgICBpZiAoYWRkY2F0ZWdvcnkgPT09IGNhdGVnb3J5LnZhbHVlKSB7CiAgICAgICAgICBmbGFnID0gZmFsc2UKICAgICAgICAgIFZ1ZS4kdG9hc3Qub3Blbih7CiAgICAgICAgICAgIG1lc3NhZ2U6ICdMYSBjYXRlZ29yaWEgZXNpc3RlIGdpw6AhJywKICAgICAgICAgICAgdHlwZTogJ3dhcm5pbmcnLAogICAgICAgICAgICBwb3NpdGlvbjogJ3RvcC1sZWZ0JwogICAgICAgICAgfSkKICAgICAgICB9CiAgICAgIH0pCiAgICAgIGlmIChmbGFnKSB7CiAgICAgICAgaWYgKHRoaXMuQ3VycmVudENhdGVnb3JpZXMubGVuZ3RoID09PSAwKSB7CiAgICAgICAgICB0aGlzLk1haW5DYXRlZ29yeShhZGRjYXRlZ29yeSkudGhlbigoZGF0YSkgPT4gewogICAgICAgICAgICBpZiAoZGF0YS5zdGF0dXMgPT09IDIwMCkgewogICAgICAgICAgICAgIFZ1ZS4kdG9hc3Qub3Blbih7CiAgICAgICAgICAgICAgICBtZXNzYWdlOiAnU2VsZXppb25hdG8gY29uIHN1Y2Nlc3NvIGNvbWUgY2F0ZWdvcmlhIHByaW5jaXBhbGUhJywKICAgICAgICAgICAgICAgIHR5cGU6ICdzdWNjZXNzJywKICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAndG9wLWxlZnQnCiAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgfQogICAgICAgICAgfSkKICAgICAgICB9CiAgICAgICAgdGhpcy5BZGRDYXRlZ29yeShhZGRjYXRlZ29yeSkudGhlbigoZGF0YSkgPT4gewogICAgICAgICAgaWYgKGRhdGEuc3RhdHVzID09PSAyMDApIHsKICAgICAgICAgICAgbGV0IHN0YXIgPSAndW5maWxsZWQnCiAgICAgICAgICAgIGlmICh0aGlzLkN1cnJlbnRDYXRlZ29yaWVzLmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgICAgIHN0YXIgPSAnZmlsbGVkJwogICAgICAgICAgICB9CiAgICAgICAgICAgIHRoaXMuQ2F0ZWdvcmllcy5mb3JFYWNoKChjYXRlZ29yeSkgPT4gewogICAgICAgICAgICAgIGlmIChjYXRlZ29yeS5pZCA9PT0gYWRkY2F0ZWdvcnkpIHsKICAgICAgICAgICAgICAgIHRoaXMuQ3VycmVudENhdGVnb3JpZXMucHVzaCh7CiAgICAgICAgICAgICAgICAgIGtleTogY2F0ZWdvcnkuZGlzcGxheSwKICAgICAgICAgICAgICAgICAgdmFsdWU6IGFkZGNhdGVnb3J5LAogICAgICAgICAgICAgICAgICB0ZXh0OiBjYXRlZ29yeS5kaXNwbGF5LAogICAgICAgICAgICAgICAgICBzdGFyOiBzdGFyCiAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSkKICAgICAgICAgICAgVnVlLiR0b2FzdC5vcGVuKHsKICAgICAgICAgICAgICBtZXNzYWdlOiAnQWdnaXVudG8gY29uIHN1Y2Nlc3NvIScsCiAgICAgICAgICAgICAgdHlwZTogJ3N1Y2Nlc3MnLAogICAgICAgICAgICAgIHBvc2l0aW9uOiAndG9wLWxlZnQnCiAgICAgICAgICAgIH0pCiAgICAgICAgICB9CiAgICAgICAgfSkKICAgICAgfQogICAgfSwKICAgIGRlbGV0ZWNhdGVnb3J5IChkZWxldGVjYXRlZ29yeSkgewogICAgICB0aGlzLkRlbGV0ZUNhdGVnb3J5KGRlbGV0ZWNhdGVnb3J5KS50aGVuKChkYXRhKSA9PiB7CiAgICAgICAgaWYgKGRhdGEuc3RhdHVzID09PSAyMDApIHsKICAgICAgICAgIGZvciAobGV0IGkgaW4gdGhpcy5DdXJyZW50Q2F0ZWdvcmllcykgewogICAgICAgICAgICBpZiAodGhpcy5DdXJyZW50Q2F0ZWdvcmllc1tpXS52YWx1ZSA9PT0gZGVsZXRlY2F0ZWdvcnkpIHsKICAgICAgICAgICAgICB0aGlzLkN1cnJlbnRDYXRlZ29yaWVzLnNwbGljZShpLCAxKQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICBpZiAodGhpcy5DdXJyZW50Q2F0ZWdvcmllcy5sZW5ndGggPT09IDEpIHsKICAgICAgICAgICAgdGhpcy5NYWluQ2F0ZWdvcnkodGhpcy5DdXJyZW50Q2F0ZWdvcmllc1swXS52YWx1ZSkKICAgICAgICAgICAgdGhpcy5DdXJyZW50Q2F0ZWdvcmllc1swXS5zdGFyID0gJ2ZpbGxlZCcKICAgICAgICAgIH0KICAgICAgICAgIFZ1ZS4kdG9hc3Qub3Blbih7CiAgICAgICAgICAgIG1lc3NhZ2U6ICdFbGltaW5hdG8gY29uIHN1Y2Nlc3NvIScsCiAgICAgICAgICAgIHR5cGU6ICdzdWNjZXNzJywKICAgICAgICAgICAgcG9zaXRpb246ICd0b3AtbGVmdCcKICAgICAgICAgIH0pCiAgICAgICAgfQogICAgICB9KQogICAgfSwKICAgIHJlc2V0ICgpIHsKICAgICAgLy8gcmVzZXQgZm9ybSB0byBpbml0aWFsIHN0YXRlCiAgICAgIHRoaXMuY3VycmVudFN0YXR1cyA9IFNUQVRVU19JTklUSUFMCiAgICAgIHRoaXMudXBsb2FkZWRGaWxlcyA9IFtdCiAgICAgIHRoaXMudXBsb2FkRXJyb3IgPSBudWxsCiAgICB9LAogICAgc2F2ZSAoZm9ybURhdGEpIHsKICAgICAgLy8gdXBsb2FkIGRhdGEgdG8gdGhlIHNlcnZlcgogICAgICB0aGlzLmN1cnJlbnRTdGF0dXMgPSBTVEFUVVNfU0FWSU5HCgogICAgICB0aGlzLnVwbG9hZChmb3JtRGF0YSkKICAgICAgICAudGhlbigoeCkgPT4gewogICAgICAgICAgdGhpcy51cGxvYWRlZEZpbGVzID0gW10uY29uY2F0KHgpCiAgICAgICAgICB0aGlzLmN1cnJlbnRTdGF0dXMgPSBTVEFUVVNfU1VDQ0VTUwogICAgICAgIH0pCiAgICAgICAgLmNhdGNoKChlcnIpID0+IHsKICAgICAgICAgIHRoaXMudXBsb2FkRXJyb3IgPSBlcnIucmVzcG9uc2UKICAgICAgICAgIHRoaXMuY3VycmVudFN0YXR1cyA9IFNUQVRVU19GQUlMRUQKICAgICAgICB9KQogICAgfSwKICAgIGZpbGVzQ2hhbmdlIChmaWVsZE5hbWUsIGZpbGVMaXN0KSB7CiAgICAgIC8vIGhhbmRsZSBmaWxlIGNoYW5nZXMKICAgICAgY29uc3QgZm9ybURhdGEgPSBuZXcgRm9ybURhdGEoKQogICAgICBpZiAoIWZpbGVMaXN0Lmxlbmd0aCkgcmV0dXJuCiAgICAgIGZvcm1EYXRhLmFwcGVuZChmaWVsZE5hbWUsIGZpbGVMaXN0WzBdLCBmaWxlTGlzdFswXS5uYW1lKQogICAgICAvLyBzYXZlIGl0CiAgICAgIHRoaXMuc2F2ZShmb3JtRGF0YSkKICAgIH0sCiAgICB1cGxvYWQgKGZvcm1EYXRhKSB7CiAgICAgIHJldHVybiBmZXRjaChgL2FwaS9zdG9yZXMvJHt0aGlzLnN0b3JlX2lkfS9pbWFnZXNgLCB7CiAgICAgICAgbWV0aG9kOiAnUE9TVCcsCiAgICAgICAgYm9keTogZm9ybURhdGEsCiAgICAgICAgaGVhZGVyczogewogICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJywKICAgICAgICAgIGFjY2VwdDogJ2FwcGxpY2F0aW9uL2pzb24nCiAgICAgICAgfQogICAgICB9KQogICAgICAgIC50aGVuKCh4KSA9PiB4Lmpzb24oKSkKICAgICAgICAudGhlbigoeCkgPT4gewogICAgICAgICAgdGhpcy5zYXZlaW1hZ2UoeC5pZCwgZm9ybURhdGEpCiAgICAgICAgfSkKICAgIH0sCiAgICBzYXZlaW1hZ2UgKGlkLCBmb3JtRGF0YSkgewogICAgICByZXR1cm4gZmV0Y2goYC9hcGkvc3RvcmVzLyR7dGhpcy5zdG9yZV9pZH0vaW1hZ2VzLyR7aWR9YCwgewogICAgICAgIG1ldGhvZDogJ1BPU1QnLAogICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgIGFjY2VwdDogJ2FwcGxpY2F0aW9uL2pzb24nLAogICAgICAgICAgbWltZXR5cGU6IGZvcm1EYXRhLmdldEFsbCgnY29udGVudHMnKVswXS50eXBlCiAgICAgICAgfSwKICAgICAgICBib2R5OiBmb3JtRGF0YQogICAgICB9KQogICAgICAgIC50aGVuKChyZXMpID0+IHJlcy5qc29uKCkpCiAgICAgICAgLnRoZW4oKHJlcykgPT4gewogICAgICAgICAgaWYgKHJlcykgewogICAgICAgICAgICBpZiAodGhpcy5JbWdVcmxzLmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgICAgIHRoaXMuSW1nVXJscy5wdXNoKHsKICAgICAgICAgICAgICAgIGlkOiByZXMuaWQsCiAgICAgICAgICAgICAgICB1cmw6IGAvYXBpL3N0b3Jlcy8ke3RoaXMuc3RvcmVfaWR9L2ltYWdlcy8ke3Jlcy5pZH1gLAogICAgICAgICAgICAgICAgY2xhc3NuYW1lOiAnY2Fyb3VzZWwtaXRlbSBhY3RpdmUnLAogICAgICAgICAgICAgICAgc3R5bGU6ICdvcGFjaXR5OiAwLjg7IGJvcmRlci1zdHlsZTpkb3VibGU7IGJvcmRlci1jb2xvcjpncmF5JwogICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgVnVlLiR0b2FzdC5vcGVuKHsKICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICdBZ2dpdW50byBjb24gc3VjY2Vzc28hJywKICAgICAgICAgICAgICAgIHR5cGU6ICdzdWNjZXNzJywKICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAndG9wLWxlZnQnCiAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICB0aGlzLkltZ1VybHMucHVzaCh7CiAgICAgICAgICAgICAgICBpZDogcmVzLmlkLAogICAgICAgICAgICAgICAgdXJsOiBgL2FwaS9zdG9yZXMvJHt0aGlzLnN0b3JlX2lkfS9pbWFnZXMvJHtyZXMuaWR9YCwKICAgICAgICAgICAgICAgIGNsYXNzbmFtZTogJ2Nhcm91c2VsLWl0ZW0nCiAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICBWdWUuJHRvYXN0Lm9wZW4oewogICAgICAgICAgICAgICAgbWVzc2FnZTogJ0FnZ2l1bnRvIGNvbiBzdWNjZXNzbyEnLAogICAgICAgICAgICAgICAgdHlwZTogJ3N1Y2Nlc3MnLAogICAgICAgICAgICAgICAgcG9zaXRpb246ICd0b3AtbGVmdCcsCiAgICAgICAgICAgICAgICBzdHlsZTogJ29wYWNpdHk6IDAuOCcKICAgICAgICAgICAgICB9KQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSkKICAgIH0sCiAgICBmb3JtYXQgKHRpbWUpIHsKICAgICAgbGV0IHJlc3VsdCA9ICcnCiAgICAgIGlmICh0aW1lLmluZGV4T2YoJzonKSA+IC0xKSB7CiAgICAgICAgaWYgKHRpbWUuc3BsaXQoJzonKVswXSA8IDEwKSB7CiAgICAgICAgICByZXN1bHQgPSAnMCcgKyB0aW1lLnNwbGl0KCc6JylbMF0gKyAnOicKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcmVzdWx0ICs9IHRpbWUuc3BsaXQoJzonKVswXSArICc6JwogICAgICAgIH0KICAgICAgICBpZiAodGltZS5zcGxpdCgnOicpWzFdIDwgMTApIHsKICAgICAgICAgIHJlc3VsdCArPSAnMCcgKyB0aW1lLnNwbGl0KCc6JylbMV0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgcmVzdWx0ICs9IHRpbWUuc3BsaXQoJzonKVsxXQogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICBpZiAodGltZSA8IDEwKSB7CiAgICAgICAgICByZXN1bHQgKz0gJzAnICsgdGltZSArICc6MDAnCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHJlc3VsdCArPSB0aW1lICsgJzowMCcKICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIHJlc3VsdAogICAgfSwKICAgIHVwZGF0ZW9wZW5pbmcgKHdlZWtkYXksIGksIG9wZW5pbmdob3VycykgewogICAgICBpZiAoZXZlbnQudGFyZ2V0LnZhbHVlID09PSAnJykgewogICAgICAgIHRoaXMuQ3VycmVudE9wZW5pbmdIb3Vyc1t3ZWVrZGF5XS5zcGxpY2UoaSwgMSkKICAgICAgfSBlbHNlIHsKICAgICAgICBsZXQgbCA9IHRoaXMuQ3VycmVudE9wZW5pbmdIb3Vyc1t3ZWVrZGF5XS5sZW5ndGgKICAgICAgICBpZiAodGhpcy5DdXJyZW50T3BlbmluZ0hvdXJzW3dlZWtkYXldLmxlbmd0aCA8PSBpKSB7CiAgICAgICAgICB0aGlzLkN1cnJlbnRPcGVuaW5nSG91cnNbd2Vla2RheV1bbF0gPSBbXQogICAgICAgIH0KICAgICAgICBpZiAob3BlbmluZ2hvdXJzLmluZGV4T2YoJywnKSA+IC0xKSB7CiAgICAgICAgICB0aGlzLkN1cnJlbnRPcGVuaW5nSG91cnNbd2Vla2RheV1bbF1bMF0gPSB0aGlzLmZvcm1hdCgKICAgICAgICAgICAgb3BlbmluZ2hvdXJzLnNwbGl0KCcsJylbMF0KICAgICAgICAgICkKICAgICAgICAgIHRoaXMuQ3VycmVudE9wZW5pbmdIb3Vyc1t3ZWVrZGF5XVtsXVsxXSA9IHRoaXMuZm9ybWF0KAogICAgICAgICAgICBvcGVuaW5naG91cnMuc3BsaXQoJywnKVsxXQogICAgICAgICAgKQogICAgICAgIH0KICAgICAgICBpZiAob3BlbmluZ2hvdXJzLmluZGV4T2YoJy0nKSA+IC0xKSB7CiAgICAgICAgICB0aGlzLkN1cnJlbnRPcGVuaW5nSG91cnNbd2Vla2RheV1bbF1bMF0gPSB0aGlzLmZvcm1hdCgKICAgICAgICAgICAgb3BlbmluZ2hvdXJzLnNwbGl0KCctJylbMF0KICAgICAgICAgICkKICAgICAgICAgIHRoaXMuQ3VycmVudE9wZW5pbmdIb3Vyc1t3ZWVrZGF5XVtsXVsxXSA9IHRoaXMuZm9ybWF0KAogICAgICAgICAgICBvcGVuaW5naG91cnMuc3BsaXQoJy0nKVsxXQogICAgICAgICAgKQogICAgICAgIH0KICAgICAgICBpZiAob3BlbmluZ2hvdXJzLmluZGV4T2YoJzsnKSA+IC0xKSB7CiAgICAgICAgICB0aGlzLkN1cnJlbnRPcGVuaW5nSG91cnNbd2Vla2RheV1bbF1bMF0gPSB0aGlzLmZvcm1hdCgKICAgICAgICAgICAgb3BlbmluZ2hvdXJzLnNwbGl0KCc7JylbMF0KICAgICAgICAgICkKICAgICAgICAgIHRoaXMuQ3VycmVudE9wZW5pbmdIb3Vyc1t3ZWVrZGF5XVtsXVsxXSA9IHRoaXMuZm9ybWF0KAogICAgICAgICAgICBvcGVuaW5naG91cnMuc3BsaXQoJzsnKVsxXQogICAgICAgICAgKQogICAgICAgIH0KICAgICAgfQogICAgICB0aGlzLlVwZGF0ZU9wZW5pbmcoKS50aGVuKChyZXNwb25zZSkgPT4gewogICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDIwMCkgewogICAgICAgICAgVnVlLiR0b2FzdC5vcGVuKHsKICAgICAgICAgICAgbWVzc2FnZTogJ0ltcG9zdGF0byBjb24gc3VjY2Vzc28hJywKICAgICAgICAgICAgdHlwZTogJ3N1Y2Nlc3MnLAogICAgICAgICAgICBwb3NpdGlvbjogJ3RvcC1sZWZ0JwogICAgICAgICAgfSkKICAgICAgICB9CiAgICAgIH0pCiAgICB9LAogICAgZGVsZXRlb3BlbmluZyAod2Vla2RheSwgaSkgewogICAgICBpZiAoaSA9PT0gJ2FsbCcgfHwgKHRoaXMuQ3VycmVudE9wZW5pbmdIb3Vycy5sZW5ndGggPT09IDEgJiYgaSA9PT0gMCkpIHsKICAgICAgICAvLyBodHRwczovL3Z1ZWpzLm9yZy92Mi9hcGkvI1Z1ZS1kZWxldGUKICAgICAgICBWdWUuZGVsZXRlKHRoaXMuQ3VycmVudE9wZW5pbmdIb3Vycywgd2Vla2RheSkKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLkN1cnJlbnRPcGVuaW5nSG91cnNbd2Vla2RheV0uc3BsaWNlKGksIDEpCiAgICAgIH0KICAgICAgdGhpcy5VcGRhdGVPcGVuaW5nKCkudGhlbigocmVzcG9uc2UpID0+IHsKICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSAyMDApIHsKICAgICAgICAgIFZ1ZS4kdG9hc3Qub3Blbih7CiAgICAgICAgICAgIG1lc3NhZ2U6ICdJbXBvc3RhdG8gY29uIHN1Y2Nlc3NvIScsCiAgICAgICAgICAgIHR5cGU6ICdzdWNjZXNzJywKICAgICAgICAgICAgcG9zaXRpb246ICd0b3AtbGVmdCcKICAgICAgICAgIH0pCiAgICAgICAgfQogICAgICB9KQogICAgfSwKICAgIHVwZGF0ZWxpdmluZyAod2Vla2RheSwgaSwgbGl2aW5naG91cnMpIHsKICAgICAgaWYgKGV2ZW50LnRhcmdldC52YWx1ZSA9PT0gJycpIHsKICAgICAgICB0aGlzLkN1cnJlbnRMaXZlU3RyZWFtaW5nW3dlZWtkYXldLnNwbGljZShpLCAxKQogICAgICB9IGVsc2UgewogICAgICAgIGxldCBsID0gdGhpcy5DdXJyZW50TGl2ZVN0cmVhbWluZ1t3ZWVrZGF5XS5sZW5ndGgKICAgICAgICBpZiAodGhpcy5DdXJyZW50TGl2ZVN0cmVhbWluZ1t3ZWVrZGF5XS5sZW5ndGggPD0gaSkgewogICAgICAgICAgdGhpcy5DdXJyZW50TGl2ZVN0cmVhbWluZ1t3ZWVrZGF5XVtsXSA9IFtdCiAgICAgICAgfQogICAgICAgIGlmIChsaXZpbmdob3Vycy5pbmRleE9mKCcsJykgPiAtMSkgewogICAgICAgICAgdGhpcy5DdXJyZW50TGl2ZVN0cmVhbWluZ1t3ZWVrZGF5XVtsXVswXSA9IHRoaXMuZm9ybWF0KAogICAgICAgICAgICBsaXZpbmdob3Vycy5zcGxpdCgnLCcpWzBdCiAgICAgICAgICApCiAgICAgICAgICB0aGlzLkN1cnJlbnRMaXZlU3RyZWFtaW5nW3dlZWtkYXldW2xdWzFdID0gdGhpcy5mb3JtYXQoCiAgICAgICAgICAgIGxpdmluZ2hvdXJzLnNwbGl0KCcsJylbMV0KICAgICAgICAgICkKICAgICAgICB9CiAgICAgICAgaWYgKGxpdmluZ2hvdXJzLmluZGV4T2YoJy0nKSA+IC0xKSB7CiAgICAgICAgICB0aGlzLkN1cnJlbnRMaXZlU3RyZWFtaW5nW3dlZWtkYXldW2xdWzBdID0gdGhpcy5mb3JtYXQoCiAgICAgICAgICAgIGxpdmluZ2hvdXJzLnNwbGl0KCctJylbMF0KICAgICAgICAgICkKICAgICAgICAgIHRoaXMuQ3VycmVudExpdmVTdHJlYW1pbmdbd2Vla2RheV1bbF1bMV0gPSB0aGlzLmZvcm1hdCgKICAgICAgICAgICAgbGl2aW5naG91cnMuc3BsaXQoJy0nKVsxXQogICAgICAgICAgKQogICAgICAgIH0KICAgICAgICBpZiAobGl2aW5naG91cnMuaW5kZXhPZignOycpID4gLTEpIHsKICAgICAgICAgIHRoaXMuQ3VycmVudExpdmVTdHJlYW1pbmdbd2Vla2RheV1bbF1bMF0gPSB0aGlzLmZvcm1hdCgKICAgICAgICAgICAgbGl2aW5naG91cnMuc3BsaXQoJzsnKVswXQogICAgICAgICAgKQogICAgICAgICAgdGhpcy5DdXJyZW50TGl2ZVN0cmVhbWluZ1t3ZWVrZGF5XVtsXVsxXSA9IHRoaXMuZm9ybWF0KAogICAgICAgICAgICBsaXZpbmdob3Vycy5zcGxpdCgnOycpWzFdCiAgICAgICAgICApCiAgICAgICAgfQogICAgICB9CiAgICAgIHRoaXMuVXBkYXRlTGl2aW5nKCkudGhlbigocmVzcG9uc2UpID0+IHsKICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSAyMDApIHsKICAgICAgICAgIFZ1ZS4kdG9hc3Qub3Blbih7CiAgICAgICAgICAgIG1lc3NhZ2U6ICdJbXBvc3RhdG8gY29uIHN1Y2Nlc3NvIScsCiAgICAgICAgICAgIHR5cGU6ICdzdWNjZXNzJywKICAgICAgICAgICAgcG9zaXRpb246ICd0b3AtbGVmdCcKICAgICAgICAgIH0pCiAgICAgICAgfQogICAgICB9KQogICAgfSwKICAgIGRlbGV0ZWxpdmluZyAod2Vla2RheSwgaSkgewogICAgICBpZiAoaSA9PT0gJ2FsbCcgfHwgKHRoaXMuQ3VycmVudExpdmVTdHJlYW1pbmcubGVuZ3RoID09PSAxICYmIGkgPT09IDApKSB7CiAgICAgICAgLy8gaHR0cHM6Ly92dWVqcy5vcmcvdjIvYXBpLyNWdWUtZGVsZXRlCiAgICAgICAgVnVlLmRlbGV0ZSh0aGlzLkN1cnJlbnRMaXZlU3RyZWFtaW5nLCB3ZWVrZGF5KQogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuQ3VycmVudExpdmVTdHJlYW1pbmdbd2Vla2RheV0uc3BsaWNlKGksIDEpCiAgICAgIH0KICAgICAgdGhpcy5VcGRhdGVMaXZpbmcoKS50aGVuKChyZXNwb25zZSkgPT4gewogICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT09IDIwMCkgewogICAgICAgICAgVnVlLiR0b2FzdC5vcGVuKHsKICAgICAgICAgICAgbWVzc2FnZTogJ0ltcG9zdGF0byBjb24gc3VjY2Vzc28hJywKICAgICAgICAgICAgdHlwZTogJ3N1Y2Nlc3MnLAogICAgICAgICAgICBwb3NpdGlvbjogJ3RvcC1sZWZ0JwogICAgICAgICAgfSkKICAgICAgICB9CiAgICAgIH0pCiAgICB9LAogICAgYXN5bmMgRGVsZXRlSW1hZ2UgKGlkKSB7CiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goCiAgICAgICAgYC9hcGkvc3RvcmVzLyR7dGhpcy5zdG9yZV9pZH0vaW1hZ2VzLyR7aWR9YCwKICAgICAgICB7CiAgICAgICAgICBtZXRob2Q6ICdERUxFVEUnLAogICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLAogICAgICAgICAgICBhY2NlcHQ6ICdhcHBsaWNhdGlvbi9qc29uJwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgKQogICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSAyMDApIHsKICAgICAgICBmb3IgKGxldCBpIGluIHRoaXMuSW1nVXJscykgewogICAgICAgICAgaWYgKHRoaXMuSW1nVXJsc1tpXS5pZCA9PT0gaWQpIHsKICAgICAgICAgICAgdGhpcy5JbWdVcmxzLnNwbGljZShpLCAxKQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBWdWUuJHRvYXN0Lm9wZW4oewogICAgICAgICAgbWVzc2FnZTogJ0VsaW1pbmF0byBjb24gc3VjY2Vzc28hJywKICAgICAgICAgIHR5cGU6ICdzdWNjZXNzJywKICAgICAgICAgIHBvc2l0aW9uOiAndG9wLWxlZnQnCiAgICAgICAgfSkKICAgICAgfQogICAgICByZXR1cm4gcmVzcG9uc2UKICAgIH0sCiAgICBhc3luYyBTZWxlY3RMb2dvIChsb2dvaWQpIHsKICAgICAgaWYgKAogICAgICAgIGNvbmZpcm0oJ1Z1b2kgc2NlZ2xpZXJlIHF1ZXN0YSBpbW1hZ2luZSBjb21lIGltbWFnaW5lIGRlbCB0dW8gbG9nbz8nKQogICAgICApIHsKICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGAvYXBpL3N0b3Jlcy8ke3RoaXMuc3RvcmVfaWR9YCwgewogICAgICAgICAgbWV0aG9kOiAnUFVUJywKICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJwogICAgICAgICAgfSwKICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgbG9nb19pZDogbG9nb2lkIH0pCiAgICAgICAgfSkKICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSAyMDApIHsKICAgICAgICAgIHRoaXMuSW1nVXJscy5mb3JFYWNoKHVybCA9PiB7CiAgICAgICAgICAgIGlmKHVybC5pZCA9PT0gdGhpcy5sb2dvX2lkKXsKICAgICAgICAgICAgICB1cmwubG9nb2ltZyA9ICcnCiAgICAgICAgICAgICAgdXJsLnN0eWxlID0gJ29wYWNpdHk6IDAuNCcKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgICB0aGlzLkltZ1VybHMuZm9yRWFjaCh1cmwgPT4gewogICAgICAgICAgICBpZih1cmwuaWQgPT09IGxvZ29pZCl7CiAgICAgICAgICAgICAgdXJsLmxvZ29pbWcgPSBgJHt0aGlzLnB1YmxpY1BhdGh9aWNvbnMvZmlsbGVkLnBuZ2AKICAgICAgICAgICAgICB1cmwuc3R5bGUgPSAnb3BhY2l0eTogMC44OyBib3JkZXItc3R5bGU6ZG91YmxlOyBib3JkZXItY29sb3I6Z3JheScKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgICBWdWUuJHRvYXN0Lm9wZW4oewogICAgICAgICAgICBtZXNzYWdlOiAnU2VsZXppb25hdG8gY29uIHN1Y2Nlc3NvIGNvbWUgbG9nbyEnLAogICAgICAgICAgICB0eXBlOiAnc3VjY2VzcycsCiAgICAgICAgICAgIHBvc2l0aW9uOiAndG9wLWxlZnQnCiAgICAgICAgICB9KQogICAgICAgIH0KICAgICAgICByZXR1cm4gcmVzcG9uc2UKICAgICAgfQogICAgfSwKICAgIGFzeW5jIFVwZGF0ZUNvbXBhbnkgKGV2ZW50KSB7CiAgICAgIGxldCBkYXRhID0ge30KICAgICAgaWYgKGV2ZW50LnRhcmdldC5jbGFzc05hbWUgPT09ICdQcm9zZU1pcnJvciBQcm9zZU1pcnJvci1mb2N1c2VkJykgewogICAgICAgIGRhdGEgPSB7IGRlc2NyaXB0aW9uOiBldmVudC50YXJnZXQuaW5uZXJIVE1MIH0KICAgICAgICB0aGlzLmRlc2NyaXB0aW9uX2xlbmd0aCA9IGV2ZW50LnRhcmdldC5pbm5lckhUTUwubGVuZ3RoCiAgICAgIH0gZWxzZSB7CiAgICAgICAgc3dpdGNoIChldmVudC50YXJnZXQubmFtZSkgewogICAgICAgICAgY2FzZSAnY29tcGFueV9uYW1lJzoKICAgICAgICAgICAgZGF0YSA9IHsgY29tcGFueV9uYW1lOiBldmVudC50YXJnZXQudmFsdWUgfQogICAgICAgICAgICBicmVhawogICAgICAgICAgY2FzZSAnYWRkcmVzcyc6CiAgICAgICAgICAgIGRhdGEgPSB7IGFkZHJlc3M6IGV2ZW50LnRhcmdldC52YWx1ZSB9CiAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICBjYXNlICdjaXR5JzoKICAgICAgICAgICAgZGF0YSA9IHsgY2l0eTogZXZlbnQudGFyZ2V0LnZhbHVlIH0KICAgICAgICAgICAgYnJlYWsKICAgICAgICAgIGNhc2UgJ3ppcCc6CiAgICAgICAgICAgIGRhdGEgPSB7IHppcDogZXZlbnQudGFyZ2V0LnZhbHVlIH0KICAgICAgICAgICAgYnJlYWsKICAgICAgICAgIGNhc2UgJ3ZhdF9pZCc6CiAgICAgICAgICAgIGRhdGEgPSB7IHZhdF9pZDogZXZlbnQudGFyZ2V0LnZhbHVlIH0KICAgICAgICAgICAgYnJlYWsKICAgICAgICAgIGNhc2UgJ2Zpc2NhbF9jb2RlJzoKICAgICAgICAgICAgZGF0YSA9IHsgZmlzY2FsX2NvZGU6IGV2ZW50LnRhcmdldC52YWx1ZSB9CiAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICBkZWZhdWx0OgogICAgICAgICAgICBicmVhawogICAgICAgIH0KICAgICAgfQogICAgICBmZXRjaChgL2FwaS9zdG9yZXMvJHt0aGlzLnN0b3JlX2lkfWAsIHsKICAgICAgICBtZXRob2Q6ICdQVVQnLAogICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicKICAgICAgICB9LAogICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGRhdGEpCiAgICAgIH0pLnRoZW4oKHJlc3BvbnNlKSA9PiB7CiAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gMjAwKSB7CiAgICAgICAgICBWdWUuJHRvYXN0Lm9wZW4oewogICAgICAgICAgICBtZXNzYWdlOiAnQWdnaW9ybmF0byBjb24gc3VjY2Vzc28hJywKICAgICAgICAgICAgdHlwZTogJ3N1Y2Nlc3MnLAogICAgICAgICAgICBwb3NpdGlvbjogJ3RvcC1sZWZ0JwogICAgICAgICAgfSkKICAgICAgICB9CiAgICAgIH0pCiAgICB9LAogICAgYXN5bmMgVXBkYXRlT3BlbmluZyAoKSB7CiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYC9hcGkvc3RvcmVzLyR7dGhpcy5zdG9yZV9pZH1gLCB7CiAgICAgICAgbWV0aG9kOiAnUFVUJywKICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nCiAgICAgICAgfSwKICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7CiAgICAgICAgICBvcGVuaW5nX2hvdXJzOiBKU09OLnN0cmluZ2lmeSh0aGlzLkN1cnJlbnRPcGVuaW5nSG91cnMpCiAgICAgICAgfSkKICAgICAgfSkKICAgICAgcmV0dXJuIHJlc3BvbnNlCiAgICB9LAogICAgYXN5bmMgVXBkYXRlTGl2aW5nICgpIHsKICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgL2FwaS9zdG9yZXMvJHt0aGlzLnN0b3JlX2lkfWAsIHsKICAgICAgICBtZXRob2Q6ICdQVVQnLAogICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicKICAgICAgICB9LAogICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsKICAgICAgICAgIGxpdmVfc3RyZWFtaW5nX29wZW5pbmdfaG91cnM6IEpTT04uc3RyaW5naWZ5KAogICAgICAgICAgICB0aGlzLkN1cnJlbnRMaXZlU3RyZWFtaW5nCiAgICAgICAgICApCiAgICAgICAgfSkKICAgICAgfSkKICAgICAgcmV0dXJuIHJlc3BvbnNlCiAgICB9LAogICAgaW5pdGlhbGl6ZSAoc3RvcmVpZCkgewogICAgICBpZiAodGhpcy5sYXRpdHVkZSAmJiB0aGlzLmxvbmdpdHVkZSkgewogICAgICAgIHRoaXMuc2hvd19tYXAgPSB0cnVlCiAgICAgICAgVnVlLm5leHRUaWNrKCgpID0+IHsKICAgICAgICAgIC8vIHVwZGF0ZSBtYXAKICAgICAgICAgIGNvbnN0IG15SWNvbiA9IEwuaWNvbih7CiAgICAgICAgICAgIGljb25Vcmw6IHRoaXMucHVibGljUGF0aCArICdpY29ucy9mYXZpY29uLnBuZycsCiAgICAgICAgICAgIGljb25TaXplOiBbMzIsIDMyXSwKICAgICAgICAgICAgc2hhZG93U2l6ZTogWzM4LCAzOF0sIC8vIHNpemUgb2YgdGhlIHNoYWRvdwogICAgICAgICAgICBpY29uQW5jaG9yOiBbMjIsIDE2XSwKICAgICAgICAgICAgc2hhZG93QW5jaG9yOiBbNCwgNjJdLAogICAgICAgICAgICBwb3B1cEFuY2hvcjogWy0zLCAtMTZdCiAgICAgICAgICB9KQogICAgICAgICAgdmFyIG1hcmtlciA9IEwubWFya2VyKFt0aGlzLmxhdGl0dWRlLCB0aGlzLmxvbmdpdHVkZV0sIHsKICAgICAgICAgICAgaWNvbjogbXlJY29uCiAgICAgICAgICB9KQogICAgICAgICAgdmFyIGNvbXBhbnluYW1lID0gdGhpcy5jb21wYW55X25hbWUKICAgICAgICAgIHZhciBtYXAgPSBMLm1hcCgnbWFwJywgewogICAgICAgICAgICBkcmFnZ2luZzogIUwuQnJvd3Nlci5tb2JpbGUsCiAgICAgICAgICAgIHRhcDogIUwuQnJvd3Nlci5tb2JpbGUKICAgICAgICAgIH0pLnNldFZpZXcoW3RoaXMubGF0aXR1ZGUsIHRoaXMubG9uZ2l0dWRlXSwgMTcpCiAgICAgICAgICBMLkRvbVV0aWwuYWRkQ2xhc3MobWFwLl9jb250YWluZXIsICdsZWFmbGV0LWNyb3NzaGFpcicpCiAgICAgICAgICBsZXQgc2VsZiA9IHRoaXMKICAgICAgICAgIG1hcC5vbignY2xpY2snLCBmdW5jdGlvbiAoZSkgewogICAgICAgICAgICBtYXAucmVtb3ZlTGF5ZXIobWFya2VyKQogICAgICAgICAgICBzZWxmLmxhdGl0dWRlID0gZS5sYXRsbmcubGF0CiAgICAgICAgICAgIHNlbGYubG9uZ2l0dWRlID0gZS5sYXRsbmcubG5nCiAgICAgICAgICAgIG1hcmtlciA9IEwubWFya2VyKFtzZWxmLmxhdGl0dWRlLCBzZWxmLmxvbmdpdHVkZV0sIHsKICAgICAgICAgICAgICBpY29uOiBteUljb24KICAgICAgICAgICAgfSkKICAgICAgICAgICAgbWFya2VyLmFkZFRvKG1hcCkuYmluZFBvcHVwKGNvbXBhbnluYW1lKS5vcGVuUG9wdXAoKQogICAgICAgICAgICBmZXRjaChgL2FwaS9zdG9yZXMvJHtzdG9yZWlkfWAsIHsKICAgICAgICAgICAgICBtZXRob2Q6ICdQVVQnLAogICAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicKICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsKICAgICAgICAgICAgICAgIGxhdGl0dWRlOiBlLmxhdGxuZy5sYXQsCiAgICAgICAgICAgICAgICBsb25naXR1ZGU6IGUubGF0bG5nLmxuZwogICAgICAgICAgICAgIH0pCiAgICAgICAgICAgIH0pLnRoZW4oKHJlc3BvbnNlKSA9PiB7CiAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PT0gMjAwKSB7CiAgICAgICAgICAgICAgICBWdWUuJHRvYXN0Lm9wZW4oewogICAgICAgICAgICAgICAgICBtZXNzYWdlOiAnQWdnaW9ybmF0byBjb24gc3VjY2Vzc28hJywKICAgICAgICAgICAgICAgICAgdHlwZTogJ3N1Y2Nlc3MnLAogICAgICAgICAgICAgICAgICBwb3NpdGlvbjogJ3RvcC1sZWZ0JwogICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pCiAgICAgICAgICB9KQogICAgICAgICAgTC50aWxlTGF5ZXIoJ2h0dHBzOi8ve3N9LnRpbGUub3BlbnN0cmVldG1hcC5vcmcve3p9L3t4fS97eX0ucG5nJywgewogICAgICAgICAgICBhdHRyaWJ1dGlvbjoKICAgICAgICAgICAgICAnJmNvcHk7IDxhIGhyZWY9Imh0dHBzOi8vd3d3Lm9wZW5zdHJlZXRtYXAub3JnL2NvcHlyaWdodCI+T3BlblN0cmVldE1hcDwvYT4gY29udHJpYnV0b3JzJwogICAgICAgICAgfSkuYWRkVG8obWFwKQogICAgICAgICAgbWFya2VyLmFkZFRvKG1hcCkuYmluZFBvcHVwKGNvbXBhbnluYW1lKS5vcGVuUG9wdXAoKQogICAgICAgIH0pCiAgICAgIH0KICAgIH0sCiAgICBhc3luYyBmZXRjaFN0b3JlIChzdG9yZUlkKSB7CiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goJy9hcGkvc3RvcmVzLycgKyBzdG9yZUlkLCB7CiAgICAgICAgbW9kZTogJ25vLWNvcnMnLAogICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgIGFjY2VwdDogJ2FwcGxpY2F0aW9uL2pzb24nCiAgICAgICAgfQogICAgICB9KQogICAgICByZXR1cm4gcmVzcG9uc2UuanNvbigpCiAgICB9LAogICAgYXN5bmMgZmV0Y2hDYXRlZ29yeSAoKSB7CiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goJy9hcGkvY2F0ZWdvcmllcycsIHsKICAgICAgICBtb2RlOiAnbm8tY29ycycsCiAgICAgICAgaGVhZGVyczogewogICAgICAgICAgYWNjZXB0OiAnYXBwbGljYXRpb24vanNvbicKICAgICAgICB9CiAgICAgIH0pCiAgICAgIHJldHVybiByZXNwb25zZS5qc29uKCkKICAgIH0sCiAgICBhc3luYyBmZXRjaExpbmsgKCkgewogICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKCcvYXBpL2xpbmtzJywgewogICAgICAgIG1vZGU6ICduby1jb3JzJywKICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICBhY2NlcHQ6ICdhcHBsaWNhdGlvbi9qc29uJwogICAgICAgIH0KICAgICAgfSkKICAgICAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKQogICAgfSwKICAgIGFzeW5jIEFkZENhdGVnb3J5IChhZGRjYXRlZ29yeSkgewogICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKAogICAgICAgIGAvYXBpL3N0b3Jlcy8ke3RoaXMuc3RvcmVfaWR9L2NhdGVnb3JpZXMvJHthZGRjYXRlZ29yeX1gLAogICAgICAgIHsKICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLAogICAgICAgICAgbW9kZTogJ25vLWNvcnMnLAogICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLAogICAgICAgICAgICBhY2NlcHQ6ICdhcHBsaWNhdGlvbi9qc29uJwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgKQogICAgICByZXR1cm4gcmVzcG9uc2UKICAgIH0sCiAgICBhc3luYyBNYWluQ2F0ZWdvcnkgKG1haW5jYXRlZ29yeSkgewogICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKAogICAgICAgIGAvYXBpL3N0b3Jlcy8ke3RoaXMuc3RvcmVfaWR9L2NhdGVnb3JpZXMvJHttYWluY2F0ZWdvcnl9L21haW5gLAogICAgICAgIHsKICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLAogICAgICAgICAgbW9kZTogJ25vLWNvcnMnLAogICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLAogICAgICAgICAgICBhY2NlcHQ6ICdhcHBsaWNhdGlvbi9qc29uJwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgKQogICAgICByZXR1cm4gcmVzcG9uc2UKICAgIH0sCiAgICBhc3luYyBEZWxldGVDYXRlZ29yeSAoZGVsZXRlY2F0ZWdvcnkpIHsKICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCgKICAgICAgICBgL2FwaS9zdG9yZXMvJHt0aGlzLnN0b3JlX2lkfS9jYXRlZ29yaWVzLyR7ZGVsZXRlY2F0ZWdvcnl9YCwKICAgICAgICB7CiAgICAgICAgICBtZXRob2Q6ICdERUxFVEUnLAogICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLAogICAgICAgICAgICBhY2NlcHQ6ICdhcHBsaWNhdGlvbi9qc29uJwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgKQogICAgICByZXR1cm4gcmVzcG9uc2UKICAgIH0sCiAgICBhc3luYyBBZGRMaW5rICgpIHsKICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCgKICAgICAgICBgL2FwaS9zdG9yZXMvJHt0aGlzLnN0b3JlX2lkfS9saW5rcy8ke3RoaXMuYWRkbGlua31gLAogICAgICAgIHsKICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLAogICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAnY29udGVudC10eXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLAogICAgICAgICAgICBhY2NlcHQ6ICdhcHBsaWNhdGlvbi9qc29uJwogICAgICAgICAgfSwKICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgdXJsOiB0aGlzLmFkZGxpbmt1cmwgfSkKICAgICAgICB9CiAgICAgICkKICAgICAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKQogICAgfSwKICAgIGFzeW5jIERlbGV0ZUxpbmsgKGlkKSB7CiAgICAgIGlmIChjb25maXJtKCdWdW9pIHJpbXVvdmVyZSBxdWVzdGEgY2F0ZWdvcmlhPycpKSB7CiAgICAgICAgZm9yIChsZXQgaSBpbiB0aGlzLkN1cnJlbnRMaW5rcykgewogICAgICAgICAgaWYgKHRoaXMuQ3VycmVudExpbmtzW2ldLmlkID09PSBpZCkgewogICAgICAgICAgICB0aGlzLkN1cnJlbnRMaW5rcy5zcGxpY2UoaSwgMSkKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCgKICAgICAgICAgIGAvYXBpL3N0b3Jlcy8ke3RoaXMuc3RvcmVfaWR9L2xpbmtzLyR7aWR9YCwKICAgICAgICAgIHsKICAgICAgICAgICAgbWV0aG9kOiAnUE9TVCcsCiAgICAgICAgICAgIG1vZGU6ICduby1jb3JzJywKICAgICAgICAgICAgaGVhZGVyczogewogICAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgICkKICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09PSAyMDApIHsKICAgICAgICAgIFZ1ZS4kdG9hc3Qub3Blbih7CiAgICAgICAgICAgIG1lc3NhZ2U6ICdFbGltaW5hdG8gY29uIHN1Y2Nlc3NvIScsCiAgICAgICAgICAgIHR5cGU6ICdzdWNjZXNzJywKICAgICAgICAgICAgcG9zaXRpb246ICd0b3AtbGVmdCcKICAgICAgICAgIH0pCiAgICAgICAgfQogICAgICAgIHJldHVybiByZXNwb25zZQogICAgICB9CiAgICB9LAogICAgb25DYXRlZ29yeUNoYW5nZSAoY3VycmVudGNhdGVnb3J5KSB7CiAgICAgIHRoaXMuQ2F0ZWdvcmllcy5mb3JFYWNoKChjYXRlZ29yeSkgPT4gewogICAgICAgIGlmIChjYXRlZ29yeS5pZCA9PT0gY3VycmVudGNhdGVnb3J5KSB7CiAgICAgICAgICB0aGlzLmNhdGVnb3J5aW1nID0gY2F0ZWdvcnkuaW1hZ2UKICAgICAgICB9CiAgICAgIH0pCiAgICB9LAogICAgc2hvd0xpbmtNZW51IChhdHRycykgewogICAgICB0aGlzLmxpbmtVcmwgPSBhdHRycy5ocmVmCiAgICAgIHRoaXMubGlua01lbnVJc0FjdGl2ZSA9IHRydWUKICAgICAgdGhpcy4kbmV4dFRpY2soKCkgPT4gewogICAgICAgIHRoaXMuJHJlZnMubGlua0lucHV0LmZvY3VzKCkKICAgICAgfSkKICAgIH0sCiAgICBoaWRlTGlua01lbnUgKCkgewogICAgICB0aGlzLmxpbmtVcmwgPSBudWxsCiAgICAgIHRoaXMubGlua01lbnVJc0FjdGl2ZSA9IGZhbHNlCiAgICB9LAogICAgc2V0TGlua1VybCAoY29tbWFuZCwgdXJsKSB7CiAgICAgIGNvbW1hbmQoeyBocmVmOiB1cmwgfSkKICAgICAgdGhpcy5oaWRlTGlua01lbnUoKQogICAgfQogIH0sCiAgbW91bnRlZDogZnVuY3Rpb24gKCkgewogICAgdGhpcy5yZXNldCgpCiAgICB0aGlzLnN0b3JlX2lkID0gdGhpcy4kcm91dGUucGFyYW1zLmlkCiAgICB0aGlzLmZldGNoU3RvcmUodGhpcy5zdG9yZV9pZCkudGhlbigoZGF0YSkgPT4gewogICAgICB0aGlzLnN0b3JlID0gZGF0YQogICAgICB0aGlzLmRlc2NyaXB0aW9uX2xlbmd0aCA9IGRhdGEuZGVzY3JpcHRpb24ubGVuZ3RoCiAgICAgIHRoaXMuZWRpdG9yLnNldENvbnRlbnQoZGF0YS5kZXNjcmlwdGlvbikKICAgICAgaWYgKGRhdGEubGF0aXR1ZGUgIT0gbnVsbCkgdGhpcy5sYXRpdHVkZSA9IGRhdGEubGF0aXR1ZGUKICAgICAgaWYgKGRhdGEubGF0aXR1ZGUgIT0gbnVsbCkgdGhpcy5sb25naXR1ZGUgPSBkYXRhLmxvbmdpdHVkZQogICAgICB0aGlzLmNvbXBhbnlfbmFtZSA9IGRhdGEuY29tcGFueV9uYW1lCiAgICAgIHRoaXMubG9nb19pZCA9IGRhdGEubG9nb19pZAogICAgICB0aGlzLkN1cnJlbnRMaW5rcyA9IGRhdGEubGlua3MKICAgICAgaWYgKGRhdGEub3BlbmluZ19ob3VycyAhPSBudWxsKSB7CiAgICAgICAgdGhpcy5DdXJyZW50T3BlbmluZ0hvdXJzID0gZGF0YS5vcGVuaW5nX2hvdXJzCiAgICAgIH0KICAgICAgaWYgKGRhdGEubGl2ZV9zdHJlYW1pbmdfb3BlbmluZ19ob3VycyAhPSBudWxsKSB7CiAgICAgICAgdGhpcy5DdXJyZW50TGl2ZVN0cmVhbWluZyA9IGRhdGEubGl2ZV9zdHJlYW1pbmdfb3BlbmluZ19ob3VycwogICAgICB9CiAgICAgIHRoaXMuaW5pdGlhbGl6ZSh0aGlzLnN0b3JlX2lkKQogICAgICBmb3IgKGxldCBjYXRlZ29yeSBpbiBkYXRhLmNhdGVnb3JpZXMpIHsKICAgICAgICBsZXQgc3RhciA9ICd1bmZpbGxlZCcKICAgICAgICBpZiAoZGF0YS5tYWluX2NhdGVnb3J5ICE9PSBudWxsKSB7CiAgICAgICAgICBpZiAoY2F0ZWdvcnkgPT09IGRhdGEubWFpbl9jYXRlZ29yeS5kaXNwbGF5KSB7CiAgICAgICAgICAgIHN0YXIgPSAnZmlsbGVkJwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICB0aGlzLkN1cnJlbnRDYXRlZ29yaWVzLnB1c2goewogICAgICAgICAga2V5OiBjYXRlZ29yeSwKICAgICAgICAgIHRleHQ6IGNhdGVnb3J5LAogICAgICAgICAgdmFsdWU6IGRhdGEuY2F0ZWdvcmllc1tjYXRlZ29yeV0sCiAgICAgICAgICBzdGFyOiBzdGFyCiAgICAgICAgfSkKICAgICAgfQogICAgICBsZXQgaSA9IDAKICAgICAgZm9yIChsZXQgdXJsID0gMDsgdXJsIDwgZGF0YS5pbWFnZXMubGVuZ3RoOyB1cmwrKykgewogICAgICAgIGxldCBjbGFzc25hbWUgPSAnJzsgbGV0IHN0eWxlID0gJycsIGxvZ29pbWc9JycKICAgICAgICBpZiAoZGF0YS5pbWFnZXNbdXJsXSAhPSBudWxsKSB7CiAgICAgICAgICBpZiAodGhpcy5JbWdVcmxzLmxlbmd0aCA9PT0gMCkgewogICAgICAgICAgICBjbGFzc25hbWUgPSAnY2Fyb3VzZWwtaXRlbSBhY3RpdmUnCiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBjbGFzc25hbWUgPSAnY2Fyb3VzZWwtaXRlbScKICAgICAgICAgIH0KICAgICAgICAgIGlmIChkYXRhLmltYWdlc1t1cmxdID09PSBkYXRhLmxvZ29faWQpIHsKICAgICAgICAgICAgc3R5bGUgPSAnb3BhY2l0eTogMC44OyBib3JkZXItc3R5bGU6ZG91YmxlOyBib3JkZXItY29sb3I6Z3JheScKICAgICAgICAgICAgbG9nb2ltZyA9IGAke3RoaXMucHVibGljUGF0aH1pY29ucy9maWxsZWQucG5nYAogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgc3R5bGUgPSAnb3BhY2l0eTogMC40JwogICAgICAgICAgfQogICAgICAgICAgdGhpcy5JbWdVcmxzLnB1c2goewogICAgICAgICAgICBrZXk6IGksCiAgICAgICAgICAgIGxvZ29pbWc6IGxvZ29pbWcsCiAgICAgICAgICAgIGlkOiBkYXRhLmltYWdlc1t1cmxdLAogICAgICAgICAgICB1cmw6IGAvYXBpL3N0b3Jlcy8ke3RoaXMuc3RvcmVfaWR9L2ltYWdlcy8ke2RhdGEuaW1hZ2VzW3VybF19YCwKICAgICAgICAgICAgY2xhc3NuYW1lOiBjbGFzc25hbWUsCiAgICAgICAgICAgIHN0eWxlOiBzdHlsZQogICAgICAgICAgfSkKICAgICAgICAgIGkrKwogICAgICAgIH0KICAgICAgfQogICAgICBjb25zb2xlLmxvZyggdGhpcy5JbWdVcmxzKQogICAgfSkKICAgIHRoaXMuZmV0Y2hDYXRlZ29yeSgpLnRoZW4oKGRhdGEpID0+IHsKICAgICAgdGhpcy5DYXRlZ29yaWVzID0gZGF0YQogICAgfSkKICAgIHRoaXMuZmV0Y2hMaW5rKCkudGhlbigoZGF0YSkgPT4gewogICAgICB0aGlzLkxpbmtzID0gZGF0YQogICAgfSkKICB9Cn0K"},{"version":3,"sources":["Store.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2sBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Store.vue","sourceRoot":"src/pages","sourcesContent":["<template>\n  <div class=\"container mt-3\">\n    <small class=\"text-muted\">{{ $options.__file }}</small>\n    <h1 class=\"text-primary font-weight-bold\">\n      <router-link to=\"/\"\n        ><img\n          src=\"~bootstrap-icons/icons/caret-left-fill.svg\"\n          alt=\"caret icon\"\n          width=\"30\"\n          height=\"30\"\n      /></router-link>\n      Vetrina digitale di: {{ store.company_name }}\n    </h1>\n    <hr />\n    <!-- <div class=\"row alert-danger\">TODO</div> -->\n    <div class=\"row m-3\">\n      <div class=\"col\">\n\n        <div class=\"card\">\n          <div class=\"card-body\">\n            <h5 class=\"card-title\">Immagini per la vetrina</h5>\n            <!-- display slide images -->\n            <div id=\"carouselExampleCaptions\" class=\"carousel slide\" data-ride=\"carousel\">\n              <ol class=\"carousel-indicators\" style=\"margin:-100px\">\n                <div\n                  v-for=\"imgurl in ImgUrls\"\n                  :key=\"imgurl.id\">\n                  <img\n                    :src=\"imgurl.url\"\n                    alt=\"\"\n                    width=\"100\"\n                    height=\"100\"\n                    data-target=\"#carouselExampleCaptions\"\n                    :data-slide-to=\"imgurl.key\"\n                    class=\"active\"\n                    :style=\"imgurl.style\"\n                  />\n                  <img :src=\"imgurl.logoimg\" alt=\"\" width=24 height=24 v-if=\"imgurl.logoimg!=''\" style=\"position:absolute; margin-left:-100px;\">\n                  <button\n                    type=\"button\"\n                    class=\"btn-close\"\n                    aria-label=\"Close\"\n                    @click=\"DeleteImage(imgurl.id)\"\n                    style=\"position:absolute; margin-left:-25px;\"\n                  ></button>\n                </div>\n              </ol>\n              <div class=\"carousel-inner\">\n                <div\n                  :class=\"imgurl.classname\"\n                  v-for=\"imgurl in ImgUrls\"\n                  :key=\"imgurl.id\"\n                  style='height: 300px;'\n                >\n                  <img\n                    :src=\"imgurl.url\"\n                    class=\"rounded mx-auto d-block\"\n                    alt=\"Image\"\n                    height='100%'\n                    @click=\"SelectLogo(imgurl.id)\"\n                  />\n                </div>\n              </div>\n              <a\n                class=\"carousel-control-prev\"\n                href=\"#carouselExampleCaptions\"\n                role=\"button\"\n                data-slide=\"prev\"\n              >\n                <span class=\"carousel-control-prev-icon\" aria-hidden=\"true\"></span>\n                <span class=\"visually-hidden\">Previous</span>\n              </a>\n              <a\n                class=\"carousel-control-next\"\n                href=\"#carouselExampleCaptions\"\n                role=\"button\"\n                data-slide=\"next\"\n              >\n                <span class=\"carousel-control-next-icon\" aria-hidden=\"true\"></span>\n                <span class=\"visually-hidden\">Next</span>\n              </a>\n            </div>\n            <!-- upload images -->\n            <form class=\"input-group mb-3\" style=\"padding-top:100px\">\n              <div class=\"form-file\">\n                <input\n                  type=\"file\"\n                  :name=\"uploadFieldName\"\n                  :disabled=\"isSaving\"\n                  @change=\"filesChange($event.target.name, $event.target.files)\"\n                  accept=\"image/*\"\n                />\n              </div>\n            </form>\n          </div>\n        </div>\n        <br />\n\n        <div class=\"card\">\n          <div class=\"card-body\">\n            <h5 class=\"card-title\">Recapiti e dati fiscali</h5>\n            <!-- display company name -->\n            <div class=\"input-group mb-3\">\n              <span class=\"input-group-text\" id=\"companyname\"\n                >Nome del negozio</span\n              >\n              <input\n                type=\"text\"\n                class=\"form-control\"\n                name=\"company_name\"\n                placeholder=\"Dall'ago al missile s.a.s.\"\n                :value=\"store.company_name\"\n                @blur=\"UpdateCompany($event)\"\n                aria-label=\"Sizing example input\"\n                aria-describedby=\"companyname\"\n              />\n            </div>\n\n            <!-- display address and city name -->\n            <div class=\"input-group mb-3\">\n              <span class=\"input-group-text\" id=\"address\">Indirizzo</span>\n              <input\n                type=\"text\"\n                class=\"form-control\"\n                name=\"address\"\n                placeholder=\"Piazza Vittoria 1\"\n                :value=\"store.address\"\n                @blur=\"UpdateCompany($event)\"\n                aria-label=\"Sizing example input\"\n                aria-describedby=\"address\"\n              />\n              <span class=\"input-group-text\" id=\"city\">Città</span>\n              <input\n                type=\"text\"\n                class=\"form-control\"\n                name=\"city\"\n                placeholder=\"Milano\"\n                :value=\"store.city\"\n                @blur=\"UpdateCompany($event)\"\n                aria-label=\"Sizing example input\"\n                aria-describedby=\"city\"\n              />\n            </div>\n\n            <!-- display zip, vat and fiscal_code name -->\n            <div class=\"input-group mb-3\">\n              <span class=\"input-group-text\" id=\"zip\">C.A.P.</span>\n              <input\n                type=\"text\"\n                class=\"form-control\"\n                name=\"zip\"\n                placeholder=\"11111\"\n                :value=\"store.zip\"\n                @blur=\"UpdateCompany($event)\"\n                aria-label=\"Sizing example input\"\n                aria-describedby=\"zip\"\n              />\n              <span class=\"input-group-text\" id=\"vat\">Partita IVA</span>\n              <input\n                type=\"text\"\n                class=\"form-control\"\n                name=\"vat_id\"\n                placeholder=\"00000000000\"\n                :value=\"store.vat_id\"\n                @blur=\"UpdateCompany($event)\"\n                aria-label=\"Sizing example input\"\n                aria-describedby=\"vat\"\n              />\n              <span class=\"input-group-text\" id=\"fiscal_code\">Codice fiscale</span>\n              <input\n                type=\"text\"\n                class=\"form-control\"\n                name=\"fiscal_code\"\n                placeholder=\"RSSMRR66G12L123W\"\n                :value=\"store.fiscal_code\"\n                @blur=\"UpdateCompany($event)\"\n                aria-label=\"Sizing example input\"\n                aria-describedby=\"fiscal_code\"\n              />\n            </div>\n            <!-- display lat/lon -->\n            <hr/>\n            <h6 class=\"card-subtitle mb-2 text-muted\">Localizza il negozio sulla mappa, zoomando e spostandoti. Quando hai trovato la posizione clicca una volta.</h6>\n            <div class=\"input-group mb-3\">\n              <span class=\"input-group-text\" id=\"latitude\">Latitudine</span>\n              <input\n                readonly\n                type=\"text\"\n                class=\"form-control\"\n                name=\"latitude\"\n                placeholder=\"\"\n                :value=\"latitude\"\n                aria-describedby=\"latitude\"\n              />\n              <span class=\"input-group-text\" id=\"longitude\">Longitudine</span>\n              <input\n                readonly\n                type=\"text\"\n                class=\"form-control\"\n                name=\"longitude\"\n                placeholder=\"\"\n                :value=\"longitude\"\n                aria-describedby=\"longitude\"\n              />\n            </div>\n            <!-- display geolocation -->\n            <div class=\"w-100\">\n              <div\n                v-show=\"this.show_map\"\n                id=\"map\"\n                style=\"width: 100%; height: 200px\"\n              ></div>\n            </div>\n          </div>\n        </div>\n        <br />\n\n        <div class=\"card\">\n          <div class=\"card-body\">\n            <!-- display tiptap discription -->\n            <div class=\"editor\">\n              <label for=\"\" style=\"font-size: 24px\">Descrizione</label>\n              <h6 class=\"card-subtitle mb-2 text-muted\">Inserire un testo breve (circa 500 caratteri), anche formattato, che descriva i punti di forza del negozio.</h6>\n              <span class=\"badge bg-dark float-right\">{{ description_length }} caratteri</span>\n              <editor-menu-bar :editor=\"editor\" v-slot=\"{ commands, isActive }\">\n                <div class=\"menubar\">\n                  <button\n                    class=\"menubar__button\"\n                    :class=\"{ 'is-active': isActive.bold() }\"\n                    @click=\"commands.bold\"\n                  >\n                    <img :src=\"publicPath + 'icons/bold.svg'\" alt=\"\" />\n                  </button>\n\n                  <button\n                    class=\"menubar__button\"\n                    :class=\"{ 'is-active': isActive.italic() }\"\n                    @click=\"commands.italic\"\n                  >\n                    <img :src=\"publicPath + 'icons/italic.svg'\" alt=\"\" />\n                  </button>\n\n                  <button\n                    class=\"menubar__button\"\n                    :class=\"{ 'is-active': isActive.strike() }\"\n                    @click=\"commands.strike\"\n                  >\n                    <img :src=\"publicPath + 'icons/strike.svg'\" alt=\"\" />\n                  </button>\n\n                  <button\n                    class=\"menubar__button\"\n                    :class=\"{ 'is-active': isActive.underline() }\"\n                    @click=\"commands.underline\"\n                  >\n                    <img :src=\"publicPath + 'icons/underline.svg'\" alt=\"\" />\n                  </button>\n\n                  <button\n                    class=\"menubar__button\"\n                    :class=\"{ 'is-active': isActive.code() }\"\n                    @click=\"commands.code\"\n                  >\n                    <img :src=\"publicPath + 'icons/code.svg'\" alt=\"\" />\n                  </button>\n\n                  <button\n                    class=\"menubar__button\"\n                    :class=\"{ 'is-active': isActive.paragraph() }\"\n                    @click=\"commands.paragraph\"\n                  >\n                    <img :src=\"publicPath + 'icons/paragraph.svg'\" alt=\"\" />\n                  </button>\n\n                  <button\n                    class=\"menubar__button\"\n                    :class=\"{ 'is-active': isActive.heading({ level: 1 }) }\"\n                    @click=\"commands.heading({ level: 1 })\"\n                  >\n                    H1\n                  </button>\n\n                  <button\n                    class=\"menubar__button\"\n                    :class=\"{ 'is-active': isActive.heading({ level: 2 }) }\"\n                    @click=\"commands.heading({ level: 2 })\"\n                  >\n                    H2\n                  </button>\n\n                  <button\n                    class=\"menubar__button\"\n                    :class=\"{ 'is-active': isActive.heading({ level: 3 }) }\"\n                    @click=\"commands.heading({ level: 3 })\"\n                  >\n                    H3\n                  </button>\n\n                  <button\n                    class=\"menubar__button\"\n                    :class=\"{ 'is-active': isActive.bullet_list() }\"\n                    @click=\"commands.bullet_list\"\n                  >\n                    <img :src=\"publicPath + 'icons/ul.svg'\" alt=\"\" />\n                  </button>\n\n                  <button\n                    class=\"menubar__button\"\n                    :class=\"{ 'is-active': isActive.ordered_list() }\"\n                    @click=\"commands.ordered_list\"\n                  >\n                    <img :src=\"publicPath + 'icons/ol.svg'\" alt=\"\" />\n                  </button>\n\n                  <button\n                    class=\"menubar__button\"\n                    :class=\"{ 'is-active': isActive.blockquote() }\"\n                    @click=\"commands.blockquote\"\n                  >\n                    <img :src=\"publicPath + 'icons/quote.svg'\" alt=\"\" />\n                  </button>\n\n                  <button\n                    class=\"menubar__button\"\n                    :class=\"{ 'is-active': isActive.code_block() }\"\n                    @click=\"commands.code_block\"\n                  >\n                    <img :src=\"publicPath + 'icons/code.svg'\" alt=\"\" />\n                  </button>\n\n                  <button\n                    class=\"menubar__button\"\n                    @click=\"commands.horizontal_rule\"\n                  >\n                    <img :src=\"publicPath + 'icons/hr.svg'\" alt=\"\" />\n                  </button>\n\n                  <button\n                    class=\"menubar__button\"\n                    :class=\"{ 'is-active': isActive.todo_list() }\"\n                    @click=\"commands.todo_list\"\n                  >\n                    <img :src=\"publicPath + 'icons/undo.svg'\" alt=\"\" />\n                  </button>\n\n                  <button class=\"menubar__button\" @click=\"commands.undo\">\n                    <img :src=\"publicPath + 'icons/undo.svg'\" alt=\"\" />\n                  </button>\n\n                  <button class=\"menubar__button\" @click=\"commands.redo\">\n                    <img :src=\"publicPath + 'icons/redo.svg'\" alt=\"\" />\n                  </button>\n                </div>\n              </editor-menu-bar>\n              <editor-menu-bubble\n                class=\"menububble\"\n                :editor=\"editor\"\n                @hide=\"hideLinkMenu\"\n                v-slot=\"{ commands, isActive, getMarkAttrs, menu }\"\n              >\n                <div\n                  class=\"menububble\"\n                  :class=\"{ 'is-active': menu.isActive }\"\n                  :style=\"`left: ${menu.left}px; bottom: ${menu.bottom}px;`\"\n                >\n                  <form\n                    class=\"menububble__form\"\n                    v-if=\"linkMenuIsActive\"\n                    @submit.prevent=\"setLinkUrl(commands.link, linkUrl)\"\n                  >\n                    <input\n                      class=\"menububble__input\"\n                      type=\"text\"\n                      v-model=\"linkUrl\"\n                      placeholder=\"https://\"\n                      ref=\"linkInput\"\n                      @keydown.esc=\"hideLinkMenu\"\n                    />\n                    <button\n                      class=\"menububble__button\"\n                      @click=\"setLinkUrl(commands.link, null)\"\n                      type=\"button\"\n                    >\n                      <img :src=\"publicPath + 'icons/remove.svg'\" alt=\"\" />\n                    </button>\n                  </form>\n\n                  <template v-else>\n                    <button\n                      class=\"menububble__button\"\n                      @click=\"showLinkMenu(getMarkAttrs('link'))\"\n                      :class=\"{ 'is-active': isActive.link() }\"\n                    >\n                      <span>{{\n                        isActive.link() ? \"Update Link\" : \"Add Link\"\n                      }}</span>\n                      <img :src=\"publicPath + 'icons/link.svg'\" alt=\"\" />\n                    </button>\n                  </template>\n                </div>\n              </editor-menu-bubble>\n              <div class=\"card\">\n                <div class=\"card-body\">\n                  <editor-content\n                    class=\"editor__content\"\n                    :editor=\"editor\"\n                    id=\"description\"\n                    name=\"description\"\n                    @keyup.enter=\"UpdateCompany($event)\"\n                  />\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n        <br />\n\n        <div class=\"card\">\n          <div class=\"card-body\">\n            <h5 class=\"card-title\">Orari di apertura del negozio</h5>\n            <!-- display opening hours -->\n            <div v-for=\"(opening, index) in CurrentOpeningHours\" :key=\"index\">\n              <button type=\"button\" class=\"btn btn-light\" style=\"width: 160px\">\n                <button\n                  type=\"button\"\n                  class=\"btn-close\"\n                  aria-label=\"Close\"\n                  @click=\"deleteopening(index, 'all')\"\n                ></button>\n                <span v-if=\"index == 0\">Lunedì</span>\n                <span v-if=\"index == 1\">Martedì</span>\n                <span v-if=\"index == 2\">Mercoledì</span>\n                <span v-if=\"index == 3\">Giovedì</span>\n                <span v-if=\"index == 4\">Venerdì</span>\n                <span v-if=\"index == 5\">Sabato</span>\n                <span v-if=\"index == 6\">Domenica</span>\n              </button>\n              <button type=\"button\" class=\"btn btn-light col-3\">\n                <input\n                  type=\"text\"\n                  class=\"col-8\"\n                  :value=\"opening[0]\"\n                  placeholder=\"fascia oraria es. 8-12\"\n                  @blur=\"updateopening(index, 0, $event.target.value)\"\n                />\n                <button\n                  type=\"button\"\n                  class=\"btn-close\"\n                  aria-label=\"Close\"\n                  @click=\"deleteopening(index, 0)\"\n                ></button>\n              </button>\n              <button type=\"button\" class=\"btn btn-light col-3\">\n                <input\n                  type=\"text\"\n                  class=\"col-8\"\n                  :value=\"opening[1]\"\n                  @blur=\"updateopening(index, 1, $event.target.value)\"\n                />\n                <button\n                  type=\"button\"\n                  class=\"btn-close\"\n                  aria-label=\"Close\"\n                  @click=\"deleteopening(index, 1)\"\n                ></button>\n              </button>\n              <button type=\"button\" class=\"btn btn-light col-3\">\n                <input\n                  type=\"text\"\n                  class=\"col-8\"\n                  :value=\"opening[2]\"\n                  @blur=\"updateopening(index, 2, $event.target.value)\"\n                />\n                <button\n                  type=\"button\"\n                  class=\"btn-close\"\n                  aria-label=\"Close\"\n                  @click=\"deleteopening(index, 2)\"\n                ></button>\n              </button>\n            </div>\n            <br />\n            <div class=\"input-group mb-3\">\n              <label for=\"week\"\n                ><img\n                  :src=\"publicPath + 'icons/plus.png'\"\n                  alt=\"\"\n                  width=\"24\"\n                  height=\"24\"\n              /></label>\n              <select id=\"week\" v-model.lazy=\"openweek\" style=\"border: 0px\">\n                <option value=\"selected\">Aggiungi giorno di apertura</option>\n                <option value=\"0\">Lunedì</option>\n                <option value=\"1\">Martedì</option>\n                <option value=\"2\">Mercoledì</option>\n                <option value=\"3\">Giovedì</option>\n                <option value=\"4\">Venerdì</option>\n                <option value=\"5\">Sabato</option>\n                <option value=\"6\">Domenica</option>\n              </select>\n            </div>\n          </div>\n        </div>\n        <br />\n\n        <div class=\"card\">\n          <div class=\"card-body\">\n            <h5 class=\"card-title\">Orari preferenziali per il live streaming</h5>\n            <!-- display live streaming opening hours -->\n            <div v-for=\"(living, index) in CurrentLiveStreaming\" :key=\"index\">\n              <button type=\"button\" class=\"btn btn-light\" style=\"width: 160px\">\n                <button\n                  type=\"button\"\n                  class=\"btn-close\"\n                  aria-label=\"Close\"\n                  @click=\"deleteliving(index, 'all')\"\n                ></button>\n                <span v-if=\"index == 0\">Lunedì</span>\n                <span v-if=\"index == 1\">Martedì</span>\n                <span v-if=\"index == 2\">Mercoledì</span>\n                <span v-if=\"index == 3\">Giovedì</span>\n                <span v-if=\"index == 4\">Venerdì</span>\n                <span v-if=\"index == 5\">Sabato</span>\n                <span v-if=\"index == 6\">Domenica</span>\n              </button>\n              <button type=\"button\" class=\"btn btn-light col-3\">\n                <input\n                  type=\"text\"\n                  class=\"col-8\"\n                  :value=\"living[0]\"\n                  placeholder=\"fascia oraria es. 8-12\"\n                  @blur=\"updateliving(index, 0, $event.target.value)\"\n                />\n                <button\n                  type=\"button\"\n                  class=\"btn-close\"\n                  aria-label=\"Close\"\n                  @click=\"deleteliving(index, 0)\"\n                ></button>\n              </button>\n              <button type=\"button\" class=\"btn btn-light col-3\">\n                <input\n                  type=\"text\"\n                  class=\"col-8\"\n                  :value=\"living[1]\"\n                  @blur=\"updateliving(index, 1, $event.target.value)\"\n                />\n                <button\n                  type=\"button\"\n                  class=\"btn-close\"\n                  aria-label=\"Close\"\n                  @click=\"deleteliving(index, 1)\"\n                ></button>\n              </button>\n              <button type=\"button\" class=\"btn btn-light col-3\">\n                <input\n                  type=\"text\"\n                  class=\"col-8\"\n                  :value=\"living[2]\"\n                  @blur=\"updateliving(index, 2, $event.target.value)\"\n                />\n                <button\n                  type=\"button\"\n                  class=\"btn-close\"\n                  aria-label=\"Close\"\n                  @click=\"deleteliving(index, 2)\"\n                ></button>\n              </button>\n            </div>\n            <br />\n            <div class=\"input-group mb-3\">\n              <label for=\"week\"\n                ><img\n                  :src=\"publicPath + 'icons/plus.png'\"\n                  alt=\"\"\n                  width=\"24\"\n                  height=\"24\"\n              /></label>\n              <select id=\"week\" v-model.lazy=\"liveweek\" style=\"border: 0px\">\n                <option value=\"selected\">Aggiungi giorno di apertura</option>\n                <option value=\"0\">Lunedì</option>\n                <option value=\"1\">Martedì</option>\n                <option value=\"2\">Mercoledì</option>\n                <option value=\"3\">Giovedì</option>\n                <option value=\"4\">Venerdì</option>\n                <option value=\"5\">Sabato</option>\n                <option value=\"6\">Domenica</option>\n              </select>\n            </div>\n          </div>\n        </div>\n        <br />\n\n        <div class=\"card\">\n          <div class=\"card-body\">\n            <h5 class=\"card-title\">Categorie merceologiche</h5>\n            <h6 class=\"card-subtitle mb-2 text-muted\">Si può selezionare più d'una categoria. Indicare col la stellina la categoria principale.</h6>\n            <!-- display categories -->\n            <button\n              type=\"button\"\n              style=\"margin-left: 10px\"\n              class=\"btn btn-success btn-sm\"\n              v-for=\"category in CurrentCategories\"\n              :key=\"category.key\"\n            >\n              <img\n                :src=\"publicPath + 'icons/' + category.star + '.png'\"\n                alt=\"\"\n                width=\"24\"\n                height=\"24\"\n                @click=\"maincategory(category.value)\"\n              />\n              {{ category.text }}\n              <button\n                type=\"button\"\n                class=\"btn-close btn-close\"\n                aria-label=\"Close\"\n                style=\"height: 10px; margin-right: -8px; color: red\"\n                @click=\"deletecategory(category.value)\"\n              ></button>\n            </button>\n            <div class=\"btn-group\" style=\"margin-left: 10px\">\n              <button\n                type=\"button\"\n                class=\"btn btn-info dropdown-toggle btn-sm\"\n                data-toggle=\"dropdown\"\n                aria-expanded=\"false\"\n              >\n                <img\n                  :src=\"publicPath + 'icons/plus.png'\"\n                  alt=\"\"\n                  width=\"24\"\n                  height=\"24\"\n                />\n                Aggiungi categoria\n              </button>\n              <ul class=\"dropdown-menu\">\n                <li>\n                  <a\n                    class=\"dropdown-item\"\n                    @click=\"addcategory(category.id)\"\n                    v-for=\"category in Categories\"\n                    :key=\"category.id\"\n                    >{{ category.id.toUpperCase() }}</a\n                  >\n                </li>\n              </ul>\n            </div>\n          </div>\n        </div>\n        <br />\n\n        <div class=\"card\">\n          <div class=\"card-body\">\n            <!-- display links -->\n            <div class=\"col\">\n              <label for=\"link\" style=\"font-size: 24px\">Collegamenti</label>\n              <table class=\"table table-hover\" id=\"link\">\n                <tbody>\n                  <tr v-for=\"link in CurrentLinks\" :key=\"link.id\">\n                    <td>\n                      <img\n                        :src=\"link.image\"\n                        alt=\"image\"\n                        with=\"20\"\n                        height=\"20\"\n                      />\n                    </td>\n                    <th>{{ link.display }}</th>\n                    <td>{{ link.url }}</td>\n                    <td>\n                      <button\n                        type=\"button\"\n                        class=\"btn btn-dark\"\n                        v-on:click=\"DeleteLink(link.id)\"\n                      >\n                        Delete\n                      </button>\n                    </td>\n                  </tr>\n                </tbody>\n              </table>\n            </div>\n            <div class=\"input-group mb-3\">\n              <label class=\"input-group-text\" for=\"addlink\">\n                <img\n                  :src=\"publicPath + 'icons/plus.png'\"\n                  alt=\"\"\n                  width=\"24\"\n                  height=\"24\"\n                />\n                Aggiungi collegamento\n              </label>\n              <select class=\"form-select\" id=\"addlink\" v-model.lazy=\"addlink\">\n                <option disabled value=\"\">Scegli il tipo di collegamento</option>\n                <option v-for=\"link in Links\" :key=\"link.id\" :value=\"link.id\">\n                  {{ link.display }}\n                </option>\n              </select>\n              <input\n                type=\"text\"\n                class=\"form-control\"\n                v-model.lazy=\"addlinkurl\"\n                placeholder=\"http://example.com\"\n              />\n            </div>\n          </div>\n        </div>\n        <br />\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport Vue from 'vue'\nimport { Editor, EditorContent, EditorMenuBar, EditorMenuBubble } from 'tiptap'\nimport {\n  Blockquote,\n  BulletList,\n  CodeBlock,\n  HardBreak,\n  Heading,\n  HorizontalRule,\n  ListItem,\n  OrderedList,\n  TodoItem,\n  TodoList,\n  Bold,\n  Code,\n  Italic,\n  Link,\n  Strike,\n  Underline,\n  History\n} from 'tiptap-extensions'\nimport 'leaflet/dist/leaflet.css'\nimport '../../public/menubar.scss'\nimport '../../public/menububble.scss'\nimport 'vue-toast-notification/dist/theme-default.css'\nimport L from 'leaflet'\nconst STATUS_INITIAL = 0\nconst STATUS_SAVING = 1\nconst STATUS_SUCCESS = 2\nconst STATUS_FAILED = 3\nexport default {\n  components: {\n    EditorContent,\n    EditorMenuBar,\n    EditorMenuBubble\n  },\n  data () {\n    return {\n      store_id: '',\n      store: {},\n      editor: new Editor({\n        onBlur: ({ event }) => {\n          this.UpdateCompany(event)\n        },\n        extensions: [\n          new Blockquote(),\n          new BulletList(),\n          new CodeBlock(),\n          new HardBreak(),\n          new Heading({ levels: [1, 2, 3] }),\n          new HorizontalRule(),\n          new ListItem(),\n          new OrderedList(),\n          new TodoItem({\n            nested: true\n          }),\n          new TodoList(),\n          new Link(),\n          new Bold(),\n          new Code(),\n          new Italic(),\n          new Strike(),\n          new Underline(),\n          new History()\n        ],\n        content: ''\n      }),\n      CurrentCategories: [],\n      Categories: [],\n      currentcategory: '',\n      categoryimg: '',\n      ImgUrls: [],\n      deleteimg: '',\n      company_name: '',\n      description_length: 0,\n      latitude: 43.87905182844069,\n      longitude: 11.102328300476076,\n      publicPath: process.env.BASE_URL,\n      show_map: false,\n      CurrentLinks: [],\n      Links: [],\n      addlink: '',\n      addlinkurl: '',\n      uploadedFiles: [],\n      uploadError: null,\n      currentStatus: null,\n      uploadFieldName: 'contents',\n      openweek: 'selected',\n      liveweek: 'selected',\n      OpeningHours: [],\n      CurrentOpeningHours: {},\n      CurrentLiveStreaming: {},\n      LiveStreaming: [],\n      linkUrl: null,\n      linkMenuIsActive: false,\n      logo_id: '',\n    }\n  },\n  beforeDestroy () {\n    this.editor.destroy()\n  },\n  watch: {\n    CurrentOpeningHours () {\n      return this.CurrentOpeningHours\n    },\n    openweek: function () {\n      let flag = true\n      for (let i in this.CurrentOpeningHours) {\n        if (i === this.openweek) {\n          flag = false\n        }\n      }\n      if (flag) {\n        if (this.openweek !== 'selected') {\n          this.CurrentOpeningHours[this.openweek] = []\n        }\n      }\n    },\n    liveweek: function () {\n      let flag = true\n      for (let i in this.CurrentLiveStreaming) {\n        if (i === this.liveweek) {\n          flag = false\n        }\n      }\n      if (flag) {\n        if (this.liveweek !== 'selected') {\n          this.CurrentLiveStreaming[this.liveweek] = []\n        }\n      }\n    },\n    addlinkurl: function () {\n      this.AddLink().then((data) => {\n        if (data) {\n          this.Links.forEach((link) => {\n            if (this.addlink === link.id) {\n              this.CurrentLinks.push({\n                id: data.id,\n                link_id: link.id,\n                display: link.display,\n                image: link.image,\n                url: this.addlinkurl\n              })\n              Vue.$toast.open({\n                message: 'Aggiunto con successo!',\n                type: 'success',\n                position: 'top-left'\n              })\n            }\n          })\n        }\n      })\n    }\n  },\n  computed: {\n    isInitial () {\n      return this.currentStatus === STATUS_INITIAL\n    },\n    isSaving () {\n      return this.currentStatus === STATUS_SAVING\n    },\n    isSuccess () {\n      return this.currentStatus === STATUS_SUCCESS\n    },\n    isFailed () {\n      return this.currentStatus === STATUS_FAILED\n    }\n  },\n  methods: {\n    maincategory (maincategory) {\n      this.MainCategory(maincategory).then((data) => {\n        if (data.status === 200) {\n          this.CurrentCategories.forEach((category) => {\n            if (category.value === maincategory) category.star = 'filled'\n            else category.star = 'unfilled'\n          })\n          Vue.$toast.open({\n            message: 'Selezionato con successo come categoria principale!',\n            type: 'success',\n            position: 'top-left'\n          })\n        }\n      })\n    },\n    addcategory (addcategory) {\n      let flag = true\n      this.CurrentCategories.forEach((category) => {\n        if (addcategory === category.value) {\n          flag = false\n          Vue.$toast.open({\n            message: 'La categoria esiste già!',\n            type: 'warning',\n            position: 'top-left'\n          })\n        }\n      })\n      if (flag) {\n        if (this.CurrentCategories.length === 0) {\n          this.MainCategory(addcategory).then((data) => {\n            if (data.status === 200) {\n              Vue.$toast.open({\n                message: 'Selezionato con successo come categoria principale!',\n                type: 'success',\n                position: 'top-left'\n              })\n            }\n          })\n        }\n        this.AddCategory(addcategory).then((data) => {\n          if (data.status === 200) {\n            let star = 'unfilled'\n            if (this.CurrentCategories.length === 0) {\n              star = 'filled'\n            }\n            this.Categories.forEach((category) => {\n              if (category.id === addcategory) {\n                this.CurrentCategories.push({\n                  key: category.display,\n                  value: addcategory,\n                  text: category.display,\n                  star: star\n                })\n              }\n            })\n            Vue.$toast.open({\n              message: 'Aggiunto con successo!',\n              type: 'success',\n              position: 'top-left'\n            })\n          }\n        })\n      }\n    },\n    deletecategory (deletecategory) {\n      this.DeleteCategory(deletecategory).then((data) => {\n        if (data.status === 200) {\n          for (let i in this.CurrentCategories) {\n            if (this.CurrentCategories[i].value === deletecategory) {\n              this.CurrentCategories.splice(i, 1)\n            }\n          }\n          if (this.CurrentCategories.length === 1) {\n            this.MainCategory(this.CurrentCategories[0].value)\n            this.CurrentCategories[0].star = 'filled'\n          }\n          Vue.$toast.open({\n            message: 'Eliminato con successo!',\n            type: 'success',\n            position: 'top-left'\n          })\n        }\n      })\n    },\n    reset () {\n      // reset form to initial state\n      this.currentStatus = STATUS_INITIAL\n      this.uploadedFiles = []\n      this.uploadError = null\n    },\n    save (formData) {\n      // upload data to the server\n      this.currentStatus = STATUS_SAVING\n\n      this.upload(formData)\n        .then((x) => {\n          this.uploadedFiles = [].concat(x)\n          this.currentStatus = STATUS_SUCCESS\n        })\n        .catch((err) => {\n          this.uploadError = err.response\n          this.currentStatus = STATUS_FAILED\n        })\n    },\n    filesChange (fieldName, fileList) {\n      // handle file changes\n      const formData = new FormData()\n      if (!fileList.length) return\n      formData.append(fieldName, fileList[0], fileList[0].name)\n      // save it\n      this.save(formData)\n    },\n    upload (formData) {\n      return fetch(`/api/stores/${this.store_id}/images`, {\n        method: 'POST',\n        body: formData,\n        headers: {\n          'Content-Type': 'application/json',\n          accept: 'application/json'\n        }\n      })\n        .then((x) => x.json())\n        .then((x) => {\n          this.saveimage(x.id, formData)\n        })\n    },\n    saveimage (id, formData) {\n      return fetch(`/api/stores/${this.store_id}/images/${id}`, {\n        method: 'POST',\n        headers: {\n          accept: 'application/json',\n          mimetype: formData.getAll('contents')[0].type\n        },\n        body: formData\n      })\n        .then((res) => res.json())\n        .then((res) => {\n          if (res) {\n            if (this.ImgUrls.length === 0) {\n              this.ImgUrls.push({\n                id: res.id,\n                url: `/api/stores/${this.store_id}/images/${res.id}`,\n                classname: 'carousel-item active',\n                style: 'opacity: 0.8; border-style:double; border-color:gray'\n              })\n              Vue.$toast.open({\n                message: 'Aggiunto con successo!',\n                type: 'success',\n                position: 'top-left'\n              })\n            } else {\n              this.ImgUrls.push({\n                id: res.id,\n                url: `/api/stores/${this.store_id}/images/${res.id}`,\n                classname: 'carousel-item'\n              })\n              Vue.$toast.open({\n                message: 'Aggiunto con successo!',\n                type: 'success',\n                position: 'top-left',\n                style: 'opacity: 0.8'\n              })\n            }\n          }\n        })\n    },\n    format (time) {\n      let result = ''\n      if (time.indexOf(':') > -1) {\n        if (time.split(':')[0] < 10) {\n          result = '0' + time.split(':')[0] + ':'\n        } else {\n          result += time.split(':')[0] + ':'\n        }\n        if (time.split(':')[1] < 10) {\n          result += '0' + time.split(':')[1]\n        } else {\n          result += time.split(':')[1]\n        }\n      } else {\n        if (time < 10) {\n          result += '0' + time + ':00'\n        } else {\n          result += time + ':00'\n        }\n      }\n      return result\n    },\n    updateopening (weekday, i, openinghours) {\n      if (event.target.value === '') {\n        this.CurrentOpeningHours[weekday].splice(i, 1)\n      } else {\n        let l = this.CurrentOpeningHours[weekday].length\n        if (this.CurrentOpeningHours[weekday].length <= i) {\n          this.CurrentOpeningHours[weekday][l] = []\n        }\n        if (openinghours.indexOf(',') > -1) {\n          this.CurrentOpeningHours[weekday][l][0] = this.format(\n            openinghours.split(',')[0]\n          )\n          this.CurrentOpeningHours[weekday][l][1] = this.format(\n            openinghours.split(',')[1]\n          )\n        }\n        if (openinghours.indexOf('-') > -1) {\n          this.CurrentOpeningHours[weekday][l][0] = this.format(\n            openinghours.split('-')[0]\n          )\n          this.CurrentOpeningHours[weekday][l][1] = this.format(\n            openinghours.split('-')[1]\n          )\n        }\n        if (openinghours.indexOf(';') > -1) {\n          this.CurrentOpeningHours[weekday][l][0] = this.format(\n            openinghours.split(';')[0]\n          )\n          this.CurrentOpeningHours[weekday][l][1] = this.format(\n            openinghours.split(';')[1]\n          )\n        }\n      }\n      this.UpdateOpening().then((response) => {\n        if (response.status === 200) {\n          Vue.$toast.open({\n            message: 'Impostato con successo!',\n            type: 'success',\n            position: 'top-left'\n          })\n        }\n      })\n    },\n    deleteopening (weekday, i) {\n      if (i === 'all' || (this.CurrentOpeningHours.length === 1 && i === 0)) {\n        // https://vuejs.org/v2/api/#Vue-delete\n        Vue.delete(this.CurrentOpeningHours, weekday)\n      } else {\n        this.CurrentOpeningHours[weekday].splice(i, 1)\n      }\n      this.UpdateOpening().then((response) => {\n        if (response.status === 200) {\n          Vue.$toast.open({\n            message: 'Impostato con successo!',\n            type: 'success',\n            position: 'top-left'\n          })\n        }\n      })\n    },\n    updateliving (weekday, i, livinghours) {\n      if (event.target.value === '') {\n        this.CurrentLiveStreaming[weekday].splice(i, 1)\n      } else {\n        let l = this.CurrentLiveStreaming[weekday].length\n        if (this.CurrentLiveStreaming[weekday].length <= i) {\n          this.CurrentLiveStreaming[weekday][l] = []\n        }\n        if (livinghours.indexOf(',') > -1) {\n          this.CurrentLiveStreaming[weekday][l][0] = this.format(\n            livinghours.split(',')[0]\n          )\n          this.CurrentLiveStreaming[weekday][l][1] = this.format(\n            livinghours.split(',')[1]\n          )\n        }\n        if (livinghours.indexOf('-') > -1) {\n          this.CurrentLiveStreaming[weekday][l][0] = this.format(\n            livinghours.split('-')[0]\n          )\n          this.CurrentLiveStreaming[weekday][l][1] = this.format(\n            livinghours.split('-')[1]\n          )\n        }\n        if (livinghours.indexOf(';') > -1) {\n          this.CurrentLiveStreaming[weekday][l][0] = this.format(\n            livinghours.split(';')[0]\n          )\n          this.CurrentLiveStreaming[weekday][l][1] = this.format(\n            livinghours.split(';')[1]\n          )\n        }\n      }\n      this.UpdateLiving().then((response) => {\n        if (response.status === 200) {\n          Vue.$toast.open({\n            message: 'Impostato con successo!',\n            type: 'success',\n            position: 'top-left'\n          })\n        }\n      })\n    },\n    deleteliving (weekday, i) {\n      if (i === 'all' || (this.CurrentLiveStreaming.length === 1 && i === 0)) {\n        // https://vuejs.org/v2/api/#Vue-delete\n        Vue.delete(this.CurrentLiveStreaming, weekday)\n      } else {\n        this.CurrentLiveStreaming[weekday].splice(i, 1)\n      }\n      this.UpdateLiving().then((response) => {\n        if (response.status === 200) {\n          Vue.$toast.open({\n            message: 'Impostato con successo!',\n            type: 'success',\n            position: 'top-left'\n          })\n        }\n      })\n    },\n    async DeleteImage (id) {\n      const response = await fetch(\n        `/api/stores/${this.store_id}/images/${id}`,\n        {\n          method: 'DELETE',\n          headers: {\n            'Content-Type': 'application/json',\n            accept: 'application/json'\n          }\n        }\n      )\n      if (response.status === 200) {\n        for (let i in this.ImgUrls) {\n          if (this.ImgUrls[i].id === id) {\n            this.ImgUrls.splice(i, 1)\n          }\n        }\n        Vue.$toast.open({\n          message: 'Eliminato con successo!',\n          type: 'success',\n          position: 'top-left'\n        })\n      }\n      return response\n    },\n    async SelectLogo (logoid) {\n      if (\n        confirm('Vuoi scegliere questa immagine come immagine del tuo logo?')\n      ) {\n        const response = await fetch(`/api/stores/${this.store_id}`, {\n          method: 'PUT',\n          headers: {\n            'Content-Type': 'application/json'\n          },\n          body: JSON.stringify({ logo_id: logoid })\n        })\n        if (response.status === 200) {\n          this.ImgUrls.forEach(url => {\n            if(url.id === this.logo_id){\n              url.logoimg = ''\n              url.style = 'opacity: 0.4'\n            }\n          });\n          this.ImgUrls.forEach(url => {\n            if(url.id === logoid){\n              url.logoimg = `${this.publicPath}icons/filled.png`\n              url.style = 'opacity: 0.8; border-style:double; border-color:gray'\n            }\n          });\n          Vue.$toast.open({\n            message: 'Selezionato con successo come logo!',\n            type: 'success',\n            position: 'top-left'\n          })\n        }\n        return response\n      }\n    },\n    async UpdateCompany (event) {\n      let data = {}\n      if (event.target.className === 'ProseMirror ProseMirror-focused') {\n        data = { description: event.target.innerHTML }\n        this.description_length = event.target.innerHTML.length\n      } else {\n        switch (event.target.name) {\n          case 'company_name':\n            data = { company_name: event.target.value }\n            break\n          case 'address':\n            data = { address: event.target.value }\n            break\n          case 'city':\n            data = { city: event.target.value }\n            break\n          case 'zip':\n            data = { zip: event.target.value }\n            break\n          case 'vat_id':\n            data = { vat_id: event.target.value }\n            break\n          case 'fiscal_code':\n            data = { fiscal_code: event.target.value }\n            break\n          default:\n            break\n        }\n      }\n      fetch(`/api/stores/${this.store_id}`, {\n        method: 'PUT',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(data)\n      }).then((response) => {\n        if (response.status === 200) {\n          Vue.$toast.open({\n            message: 'Aggiornato con successo!',\n            type: 'success',\n            position: 'top-left'\n          })\n        }\n      })\n    },\n    async UpdateOpening () {\n      const response = await fetch(`/api/stores/${this.store_id}`, {\n        method: 'PUT',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          opening_hours: JSON.stringify(this.CurrentOpeningHours)\n        })\n      })\n      return response\n    },\n    async UpdateLiving () {\n      const response = await fetch(`/api/stores/${this.store_id}`, {\n        method: 'PUT',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          live_streaming_opening_hours: JSON.stringify(\n            this.CurrentLiveStreaming\n          )\n        })\n      })\n      return response\n    },\n    initialize (storeid) {\n      if (this.latitude && this.longitude) {\n        this.show_map = true\n        Vue.nextTick(() => {\n          // update map\n          const myIcon = L.icon({\n            iconUrl: this.publicPath + 'icons/favicon.png',\n            iconSize: [32, 32],\n            shadowSize: [38, 38], // size of the shadow\n            iconAnchor: [22, 16],\n            shadowAnchor: [4, 62],\n            popupAnchor: [-3, -16]\n          })\n          var marker = L.marker([this.latitude, this.longitude], {\n            icon: myIcon\n          })\n          var companyname = this.company_name\n          var map = L.map('map', {\n            dragging: !L.Browser.mobile,\n            tap: !L.Browser.mobile\n          }).setView([this.latitude, this.longitude], 17)\n          L.DomUtil.addClass(map._container, 'leaflet-crosshair')\n          let self = this\n          map.on('click', function (e) {\n            map.removeLayer(marker)\n            self.latitude = e.latlng.lat\n            self.longitude = e.latlng.lng\n            marker = L.marker([self.latitude, self.longitude], {\n              icon: myIcon\n            })\n            marker.addTo(map).bindPopup(companyname).openPopup()\n            fetch(`/api/stores/${storeid}`, {\n              method: 'PUT',\n              headers: {\n                'Content-Type': 'application/json'\n              },\n              body: JSON.stringify({\n                latitude: e.latlng.lat,\n                longitude: e.latlng.lng\n              })\n            }).then((response) => {\n              if (response.status === 200) {\n                Vue.$toast.open({\n                  message: 'Aggiornato con successo!',\n                  type: 'success',\n                  position: 'top-left'\n                })\n              }\n            })\n          })\n          L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {\n            attribution:\n              '&copy; <a href=\"https://www.openstreetmap.org/copyright\">OpenStreetMap</a> contributors'\n          }).addTo(map)\n          marker.addTo(map).bindPopup(companyname).openPopup()\n        })\n      }\n    },\n    async fetchStore (storeId) {\n      const response = await fetch('/api/stores/' + storeId, {\n        mode: 'no-cors',\n        headers: {\n          accept: 'application/json'\n        }\n      })\n      return response.json()\n    },\n    async fetchCategory () {\n      const response = await fetch('/api/categories', {\n        mode: 'no-cors',\n        headers: {\n          accept: 'application/json'\n        }\n      })\n      return response.json()\n    },\n    async fetchLink () {\n      const response = await fetch('/api/links', {\n        mode: 'no-cors',\n        headers: {\n          accept: 'application/json'\n        }\n      })\n      return response.json()\n    },\n    async AddCategory (addcategory) {\n      const response = await fetch(\n        `/api/stores/${this.store_id}/categories/${addcategory}`,\n        {\n          method: 'POST',\n          mode: 'no-cors',\n          headers: {\n            'Content-Type': 'application/json',\n            accept: 'application/json'\n          }\n        }\n      )\n      return response\n    },\n    async MainCategory (maincategory) {\n      const response = await fetch(\n        `/api/stores/${this.store_id}/categories/${maincategory}/main`,\n        {\n          method: 'POST',\n          mode: 'no-cors',\n          headers: {\n            'Content-Type': 'application/json',\n            accept: 'application/json'\n          }\n        }\n      )\n      return response\n    },\n    async DeleteCategory (deletecategory) {\n      const response = await fetch(\n        `/api/stores/${this.store_id}/categories/${deletecategory}`,\n        {\n          method: 'DELETE',\n          headers: {\n            'Content-Type': 'application/json',\n            accept: 'application/json'\n          }\n        }\n      )\n      return response\n    },\n    async AddLink () {\n      const response = await fetch(\n        `/api/stores/${this.store_id}/links/${this.addlink}`,\n        {\n          method: 'POST',\n          headers: {\n            'content-type': 'application/json',\n            accept: 'application/json'\n          },\n          body: JSON.stringify({ url: this.addlinkurl })\n        }\n      )\n      return response.json()\n    },\n    async DeleteLink (id) {\n      if (confirm('Vuoi rimuovere questa categoria?')) {\n        for (let i in this.CurrentLinks) {\n          if (this.CurrentLinks[i].id === id) {\n            this.CurrentLinks.splice(i, 1)\n          }\n        }\n        const response = await fetch(\n          `/api/stores/${this.store_id}/links/${id}`,\n          {\n            method: 'POST',\n            mode: 'no-cors',\n            headers: {\n              'Content-Type': 'application/json'\n            }\n          }\n        )\n        if (response.status === 200) {\n          Vue.$toast.open({\n            message: 'Eliminato con successo!',\n            type: 'success',\n            position: 'top-left'\n          })\n        }\n        return response\n      }\n    },\n    onCategoryChange (currentcategory) {\n      this.Categories.forEach((category) => {\n        if (category.id === currentcategory) {\n          this.categoryimg = category.image\n        }\n      })\n    },\n    showLinkMenu (attrs) {\n      this.linkUrl = attrs.href\n      this.linkMenuIsActive = true\n      this.$nextTick(() => {\n        this.$refs.linkInput.focus()\n      })\n    },\n    hideLinkMenu () {\n      this.linkUrl = null\n      this.linkMenuIsActive = false\n    },\n    setLinkUrl (command, url) {\n      command({ href: url })\n      this.hideLinkMenu()\n    }\n  },\n  mounted: function () {\n    this.reset()\n    this.store_id = this.$route.params.id\n    this.fetchStore(this.store_id).then((data) => {\n      this.store = data\n      this.description_length = data.description.length\n      this.editor.setContent(data.description)\n      if (data.latitude != null) this.latitude = data.latitude\n      if (data.latitude != null) this.longitude = data.longitude\n      this.company_name = data.company_name\n      this.logo_id = data.logo_id\n      this.CurrentLinks = data.links\n      if (data.opening_hours != null) {\n        this.CurrentOpeningHours = data.opening_hours\n      }\n      if (data.live_streaming_opening_hours != null) {\n        this.CurrentLiveStreaming = data.live_streaming_opening_hours\n      }\n      this.initialize(this.store_id)\n      for (let category in data.categories) {\n        let star = 'unfilled'\n        if (data.main_category !== null) {\n          if (category === data.main_category.display) {\n            star = 'filled'\n          }\n        }\n        this.CurrentCategories.push({\n          key: category,\n          text: category,\n          value: data.categories[category],\n          star: star\n        })\n      }\n      let i = 0\n      for (let url = 0; url < data.images.length; url++) {\n        let classname = ''; let style = '', logoimg=''\n        if (data.images[url] != null) {\n          if (this.ImgUrls.length === 0) {\n            classname = 'carousel-item active'\n          } else {\n            classname = 'carousel-item'\n          }\n          if (data.images[url] === data.logo_id) {\n            style = 'opacity: 0.8; border-style:double; border-color:gray'\n            logoimg = `${this.publicPath}icons/filled.png`\n          } else {\n            style = 'opacity: 0.4'\n          }\n          this.ImgUrls.push({\n            key: i,\n            logoimg: logoimg,\n            id: data.images[url],\n            url: `/api/stores/${this.store_id}/images/${data.images[url]}`,\n            classname: classname,\n            style: style\n          })\n          i++\n        }\n      }\n      console.log( this.ImgUrls)\n    })\n    this.fetchCategory().then((data) => {\n      this.Categories = data\n    })\n    this.fetchLink().then((data) => {\n      this.Links = data\n    })\n  }\n}\n</script>\n"]}]}