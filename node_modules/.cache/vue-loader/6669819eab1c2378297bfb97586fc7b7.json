{"remainingRequest":"D:\\working\\Vue\\zuly\\zuly\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\working\\Vue\\zuly\\zuly\\src\\pages\\Live.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\working\\Vue\\zuly\\zuly\\src\\pages\\Live.vue","mtime":1603842703511},{"path":"D:\\working\\Vue\\zuly\\zuly\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\working\\Vue\\zuly\\zuly\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\working\\Vue\\zuly\\zuly\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\working\\Vue\\zuly\\zuly\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgJ3dlYnJ0Yy1hZGFwdGVyJw0KaW1wb3J0IGlvIGZyb20gJ3NvY2tldC5pby1jbGllbnQnDQoNCnZhciBwY0NvbmZpZyA9IHsNCiAgJ2ljZVNlcnZlcnMnOiBbew0KICAgICd1cmxzJzogJ3N0dW46c3R1bi5sLmdvb2dsZS5jb206MTkzMDInDQogIH0sDQogIHsNCiAgICAndXJscyc6ICd0dXJuOnp1bHkuaXQ6MzQ3OCcsDQogICAgJ2NyZWRlbnRpYWwnOiAndGVzdDEnLA0KICAgICd1c2VybmFtZSc6ICd0ZXN0MScNCiAgfV0NCn0NCg0KZXhwb3J0IGRlZmF1bHQgew0KICBkYXRhICgpIHsNCiAgICByZXR1cm4gew0KICAgICAgcHVibGljUGF0aDogcHJvY2Vzcy5lbnYuQkFTRV9VUkwsDQogICAgICBzdG9yZV9pZDogbnVsbCwNCiAgICAgIGNvbnRhY3RfaWQ6ICcnLA0KICAgICAgbmFtZTogJ1Bhb2xvIEdyZXBwaScNCiAgICB9DQogIH0sDQogIG1ldGhvZHM6IHsNCiAgICBzZW5kTWVzc2FnZTogZnVuY3Rpb24gKG1lc3NhZ2UpIHsNCiAgICAgIGNvbnNvbGUubG9nKCdDbGllbnQgc2VuZGluZyBtZXNzYWdlOiAnLCBtZXNzYWdlKQ0KICAgICAgdGhpcy4kcGFyZW50LnNvY2tldC5lbWl0KCdtZXNzYWdlJywgbWVzc2FnZSkNCiAgICB9LA0KICAgIGdvdFN0cmVhbTogZnVuY3Rpb24gKHN0cmVhbSkgew0KICAgICAgY29uc29sZS5sb2coJ0FkZGluZyBsb2NhbCBzdHJlYW0uJykNCiAgICAgIHRoaXMuJHBhcmVudC5sb2NhbFN0cmVhbSA9IHN0cmVhbQ0KICAgICAgdmFyIGxvY2FsVmlkZW8gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjbG9jYWxWaWRlbycpDQogICAgICBsb2NhbFZpZGVvLnNyY09iamVjdCA9IHN0cmVhbQ0KICAgICAgdGhpcy4kcGFyZW50LmxpdmVfc3RyZWFtaW5nID0gd2luZG93LmxvY2F0aW9uLnBhdGhuYW1lDQogICAgfSwNCiAgICBtYXliZVN0YXJ0OiBmdW5jdGlvbiAoKSB7DQogICAgICBjb25zb2xlLmxvZygnPj4+Pj4+PiBtYXliZVN0YXJ0KCkgJywgdGhpcy4kcGFyZW50LmlzU3RhcnRlZCwgdGhpcy4kcGFyZW50LmxvY2FsU3RyZWFtLCB0aGlzLiRwYXJlbnQuaXNDaGFubmVsUmVhZHkpDQogICAgICBpZiAodHlwZW9mIHRoaXMuJHBhcmVudC5sb2NhbFN0cmVhbSAhPT0gJ3VuZGVmaW5lZCcgJiYgdGhpcy4kcGFyZW50LmlzQ2hhbm5lbFJlYWR5KSB7DQogICAgICAgIGNvbnNvbGUubG9nKCc+Pj4+Pj4gY3JlYXRpbmcgcGVlciBjb25uZWN0aW9uJykNCiAgICAgICAgdGhpcy5jcmVhdGVQZWVyQ29ubmVjdGlvbigpDQogICAgICAgIHRoaXMuJHBhcmVudC5wZWVyQ29ubmVjdGlvbi5hZGRTdHJlYW0odGhpcy4kcGFyZW50LmxvY2FsU3RyZWFtKQ0KICAgICAgICB0aGlzLiRwYXJlbnQuaXNTdGFydGVkID0gdHJ1ZQ0KICAgICAgICB0aGlzLmRvQ2FsbCgpDQogICAgICB9DQogICAgfSwNCiAgICBjcmVhdGVQZWVyQ29ubmVjdGlvbjogZnVuY3Rpb24gKCkgew0KICAgICAgdHJ5IHsNCiAgICAgICAgdGhpcy4kcGFyZW50LnBlZXJDb25uZWN0aW9uID0gbmV3IFJUQ1BlZXJDb25uZWN0aW9uKHBjQ29uZmlnKQ0KICAgICAgICB0aGlzLiRwYXJlbnQucGVlckNvbm5lY3Rpb24ub25pY2VjYW5kaWRhdGUgPSB0aGlzLmhhbmRsZUljZUNhbmRpZGF0ZQ0KICAgICAgICB0aGlzLiRwYXJlbnQucGVlckNvbm5lY3Rpb24ub25yZW1vdmVzdHJlYW0gPSB0aGlzLmhhbmRsZVJlbW90ZVN0cmVhbVJlbW92ZWQNCiAgICAgICAgY29uc29sZS5sb2coJ0NyZWF0ZWQgUlRDUGVlckNvbm5uZWN0aW9uJykNCiAgICAgIH0gY2F0Y2ggKGUpIHsNCiAgICAgICAgY29uc29sZS5sb2coJ0ZhaWxlZCB0byBjcmVhdGUgUGVlckNvbm5lY3Rpb24sIGV4Y2VwdGlvbjogJyArIGUubWVzc2FnZSkNCiAgICAgICAgYWxlcnQoJ0Nhbm5vdCBjcmVhdGUgUlRDUGVlckNvbm5lY3Rpb24gb2JqZWN0LicpDQogICAgICB9DQogICAgfSwNCiAgICBoYW5kbGVJY2VDYW5kaWRhdGU6IGZ1bmN0aW9uIChldmVudCkgew0KICAgICAgY29uc29sZS5sb2coJ2ljZWNhbmRpZGF0ZSBldmVudDogJywgZXZlbnQpDQogICAgICBpZiAoZXZlbnQuY2FuZGlkYXRlKSB7DQogICAgICAgIHRoaXMuc2VuZE1lc3NhZ2Uoew0KICAgICAgICAgIHR5cGU6ICdjYW5kaWRhdGUnLA0KICAgICAgICAgIGxhYmVsOiBldmVudC5jYW5kaWRhdGUuc2RwTUxpbmVJbmRleCwNCiAgICAgICAgICBpZDogZXZlbnQuY2FuZGlkYXRlLnNkcE1pZCwNCiAgICAgICAgICBjYW5kaWRhdGU6IGV2ZW50LmNhbmRpZGF0ZS5jYW5kaWRhdGUNCiAgICAgICAgfSkNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIGNvbnNvbGUubG9nKCdFbmQgb2YgY2FuZGlkYXRlcy4nKQ0KICAgICAgfQ0KICAgIH0sDQogICAgaGFuZGxlQ3JlYXRlT2ZmZXJFcnJvcjogZnVuY3Rpb24gKGV2ZW50KSB7DQogICAgICBjb25zb2xlLmxvZygnY3JlYXRlT2ZmZXIoKSBlcnJvcjogJywgZXZlbnQpDQogICAgfSwNCiAgICBkb0NhbGw6IGZ1bmN0aW9uICgpIHsNCiAgICAgIGNvbnNvbGUubG9nKCdTZW5kaW5nIG9mZmVyIHRvIHBlZXInKQ0KICAgICAgdGhpcy4kcGFyZW50LnBlZXJDb25uZWN0aW9uLmNyZWF0ZU9mZmVyKHRoaXMuc2V0TG9jYWxBbmRTZW5kTWVzc2FnZSwgdGhpcy5oYW5kbGVDcmVhdGVPZmZlckVycm9yKQ0KICAgIH0sDQogICAgc2V0TG9jYWxBbmRTZW5kTWVzc2FnZTogZnVuY3Rpb24gKHNlc3Npb25EZXNjcmlwdGlvbikgew0KICAgICAgdGhpcy4kcGFyZW50LnBlZXJDb25uZWN0aW9uLnNldExvY2FsRGVzY3JpcHRpb24oc2Vzc2lvbkRlc2NyaXB0aW9uKQ0KICAgICAgY29uc29sZS5sb2coJ3NldExvY2FsQW5kU2VuZE1lc3NhZ2Ugc2VuZGluZyBtZXNzYWdlJywgc2Vzc2lvbkRlc2NyaXB0aW9uKQ0KICAgICAgdGhpcy5zZW5kTWVzc2FnZShzZXNzaW9uRGVzY3JpcHRpb24pDQogICAgfSwNCiAgICBoYW5kbGVSZW1vdGVTdHJlYW1SZW1vdmVkOiBmdW5jdGlvbiAoZXZlbnQpIHsNCiAgICAgIGNvbnNvbGUubG9nKCdSZW1vdGUgc3RyZWFtIHJlbW92ZWQuIEV2ZW50OiAnLCBldmVudCkNCiAgICB9LA0KICAgIGhhbmd1cDogZnVuY3Rpb24gKCkgew0KICAgICAgY29uc29sZS5sb2coJ0hhbmdpbmcgdXAuJykNCiAgICAgIHRoaXMuc3RvcCgpDQogICAgICBpZiAoJ2dldFRyYWNrcycgaW4gdGhpcy4kcGFyZW50LmxvY2FsU3RyZWFtKSB7DQogICAgICAgIHRoaXMuJHBhcmVudC5sb2NhbFN0cmVhbS5nZXRUcmFja3MoKS5mb3JFYWNoKGZ1bmN0aW9uICh0cmFjaykgew0KICAgICAgICAgIGlmICh0cmFjay5yZWFkeVN0YXRlID09PSAnbGl2ZScpIHsNCiAgICAgICAgICAgIHRyYWNrLnN0b3AoKQ0KICAgICAgICAgIH0NCiAgICAgICAgfSkNCiAgICAgIH0NCiAgICAgIHRoaXMuJHBhcmVudC5zb2NrZXQuZW1pdCgnY2xvc2UnLCB0aGlzLmNvbnRhY3RfaWQpDQogICAgfSwNCiAgICBoYW5kbGVSZW1vdGVIYW5ndXA6IGZ1bmN0aW9uICgpIHsNCiAgICAgIGNvbnNvbGUubG9nKCdTZXNzaW9uIHRlcm1pbmF0ZWQuJykNCiAgICAgIHRoaXMuc3RvcCgpDQogICAgfSwNCiAgICBzdG9wOiBmdW5jdGlvbiAoKSB7DQogICAgICB0aGlzLiRwYXJlbnQubGl2ZV9zdHJlYW1pbmcgPSAnJw0KICAgICAgdGhpcy4kcGFyZW50LmlzU3RhcnRlZCA9IGZhbHNlDQogICAgICBpZiAodGhpcy4kcGFyZW50LnBlZXJDb25uZWN0aW9uKSB7DQogICAgICAgIHRoaXMuJHBhcmVudC5wZWVyQ29ubmVjdGlvbi5jbG9zZSgpDQogICAgICAgIHRoaXMuJHBhcmVudC5wZWVyQ29ubmVjdGlvbiA9IG51bGwNCiAgICAgIH0NCiAgICB9DQogIH0sDQogIGNyZWF0ZWQ6IGZ1bmN0aW9uICgpIHsNCiAgICBjb25zb2xlLmxvZygnTGl2ZSBjcmVhdGVkJykNCiAgfSwNCiAgbW91bnRlZDogZnVuY3Rpb24gKCkgew0KICAgIGNvbnNvbGUubG9nKCdMaXZlIG1vdW50ZWQnKQ0KDQogICAgdGhpcy5zdG9yZV9pZCA9IHRoaXMuJHJvdXRlLnBhcmFtcy5pZA0KICAgIHRoaXMuY29udGFjdF9pZCA9IHRoaXMuJHJvdXRlLnBhcmFtcy5jb250YWN0X2lkDQoNCiAgICB0aGlzLiRwYXJlbnQuc29ja2V0ID0gaW8uY29ubmVjdCgpDQoNCiAgICB0aGlzLiRwYXJlbnQuc29ja2V0Lm9uKCdvcGVuZWQnLCAocm9vbSkgPT4gew0KICAgICAgY29uc29sZS5sb2coJ09wZW5lZCByb29tICcgKyByb29tKQ0KICAgIH0pDQoNCiAgICB0aGlzLiRwYXJlbnQuc29ja2V0Lm9uKCdmdWxsJywgKHJvb20pID0+IHsNCiAgICAgIGNvbnNvbGUubG9nKCdSb29tICcgKyByb29tICsgJyBpcyBmdWxsJykNCiAgICB9KQ0KDQogICAgdGhpcy4kcGFyZW50LnNvY2tldC5vbignam9pbicsIChyb29tKSA9PiB7DQogICAgICBjb25zb2xlLmxvZygnQW5vdGhlciBwZWVyIG1hZGUgYSByZXF1ZXN0IHRvIGpvaW4gcm9vbSAnICsgcm9vbSkNCiAgICAgIGNvbnNvbGUubG9nKCdUaGlzIHBlZXIgaXMgdGhlIGluaXRpYXRvciBvZiByb29tICcgKyByb29tICsgJyEnKQ0KICAgICAgdGhpcy4kcGFyZW50LmlzQ2hhbm5lbFJlYWR5ID0gdHJ1ZQ0KICAgIH0pDQoNCiAgICB0aGlzLiRwYXJlbnQuc29ja2V0Lm9uKCdqb2luZWQnLCAocm9vbSkgPT4gew0KICAgICAgY29uc29sZS5sb2coJ2pvaW5lZDogJyArIHJvb20pDQogICAgICB0aGlzLiRwYXJlbnQuaXNDaGFubmVsUmVhZHkgPSB0cnVlDQogICAgfSkNCg0KICAgIHRoaXMuJHBhcmVudC5zb2NrZXQub24oJ2xvZycsIChhcnJheSkgPT4gew0KICAgICAgY29uc29sZS5sb2cuYXBwbHkoY29uc29sZSwgYXJyYXkpDQogICAgfSkNCg0KICAgIC8vIFRoaXMgY2xpZW50IHJlY2VpdmVzIGEgbWVzc2FnZQ0KICAgIHRoaXMuJHBhcmVudC5zb2NrZXQub24oJ21lc3NhZ2UnLCAobWVzc2FnZSkgPT4gew0KICAgICAgY29uc29sZS5sb2coJ0NsaWVudCByZWNlaXZlZCBtZXNzYWdlOicsIG1lc3NhZ2UpDQogICAgICBpZiAobWVzc2FnZSA9PT0gJ2dvdCB1c2VyIG1lZGlhJykgew0KICAgICAgICB0aGlzLm1heWJlU3RhcnQoKQ0KICAgICAgfSBlbHNlIGlmIChtZXNzYWdlLnR5cGUgPT09ICdhbnN3ZXInICYmIHRoaXMuJHBhcmVudC5pc1N0YXJ0ZWQpIHsNCiAgICAgICAgdGhpcy4kcGFyZW50LnBlZXJDb25uZWN0aW9uLnNldFJlbW90ZURlc2NyaXB0aW9uKG5ldyBSVENTZXNzaW9uRGVzY3JpcHRpb24obWVzc2FnZSkpDQogICAgICB9IGVsc2UgaWYgKG1lc3NhZ2UudHlwZSA9PT0gJ2NhbmRpZGF0ZScgJiYgdGhpcy4kcGFyZW50LmlzU3RhcnRlZCkgew0KICAgICAgICB2YXIgY2FuZGlkYXRlID0gbmV3IFJUQ0ljZUNhbmRpZGF0ZSh7DQogICAgICAgICAgc2RwTUxpbmVJbmRleDogbWVzc2FnZS5sYWJlbCwNCiAgICAgICAgICBjYW5kaWRhdGU6IG1lc3NhZ2UuY2FuZGlkYXRlDQogICAgICAgIH0pDQogICAgICAgIHRoaXMuJHBhcmVudC5wZWVyQ29ubmVjdGlvbi5hZGRJY2VDYW5kaWRhdGUoY2FuZGlkYXRlKQ0KICAgICAgfSBlbHNlIGlmIChtZXNzYWdlID09PSAnYnllJyAmJiB0aGlzLiRwYXJlbnQuaXNTdGFydGVkKSB7DQogICAgICAgIHRoaXMuaGFuZGxlUmVtb3RlSGFuZ3VwKCkNCiAgICAgIH0NCiAgICB9KQ0KDQogICAgd2luZG93Lm9uYmVmb3JldW5sb2FkID0gKCkgPT4gew0KICAgICAgdGhpcy5zZW5kTWVzc2FnZSgnYnllJykNCiAgICAgIHJldHVybiBudWxsDQogICAgfQ0KDQogICAgaWYgKHRoaXMuJHBhcmVudC5saXZlX3N0cmVhbWluZykgew0KICAgICAgdmFyIGxvY2FsVmlkZW8gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjbG9jYWxWaWRlbycpDQogICAgICBsb2NhbFZpZGVvLnNyY09iamVjdCA9IHRoaXMuJHBhcmVudC5sb2NhbFN0cmVhbQ0KICAgIH0gZWxzZSB7DQogICAgICBpZiAodGhpcy5jb250YWN0X2lkICE9PSAnJykgew0KICAgICAgICB0aGlzLiRwYXJlbnQuc29ja2V0LmVtaXQoJ29wZW4nLCB0aGlzLmNvbnRhY3RfaWQpDQogICAgICAgIGNvbnNvbGUubG9nKCdBdHRlbXB0ZWQgdG8gb3BlbiByb29tOiAnLCB0aGlzLmNvbnRhY3RfaWQpDQogICAgICB9DQogICAgICAvLyB3aW5kb3cubmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRVc2VyTWVkaWEoew0KICAgICAgLy8gICBhdWRpbzogZmFsc2UsDQogICAgICAvLyAgIHZpZGVvOiB0cnVlDQogICAgICAvLyB9KQ0KICAgICAgLy8gICAudGhlbih0aGlzLmdvdFN0cmVhbSkNCiAgICAgIC8vICAgLmNhdGNoKGZ1bmN0aW9uIChlKSB7DQogICAgICAvLyAgICAgYWxlcnQoJ2dldFVzZXJNZWRpYSgpIGVycm9yOiAnICsgZS5uYW1lKQ0KICAgICAgLy8gICB9KQ0KICAgIH0NCiAgfQ0KfQ0KDQo="},{"version":3,"sources":["Live.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;AAqBA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Live.vue","sourceRoot":"src/pages","sourcesContent":["<template>\r\n  <div class=\"container mt-3\">\r\n    <small class=\"text-muted\">{{ $options.__file }}</small>\r\n    <h1 class=\"text-primary font-weight-bold\">\r\n      <router-link :to=\"'/contact/' + contact_id\"><img src=\"~bootstrap-icons/icons/caret-left-fill.svg\" alt=\"caret icon\" width=\"30\" height=\"30\"></router-link>\r\n      Live-streaming con {{ name }}\r\n    </h1>\r\n    <p>Invia questo link a {{ name }}: <a target=\"_blank\" :href=\"'https://zuly.it/store/' + store_id + '/live/' + contact_id\">https://zuly.it/store/{{ store_id }}/live/{{ contact_id }}</a></p>\r\n    <div class=\"btn-group\" role=\"group\" aria-label=\"Invia live-streaming link\">\r\n      <a class=\"btn btn-secondary\" href=\"#\" role=\"button\"><img src=\"~bootstrap-icons/icons/telephone-outbound.svg\" alt=\"phone icon\" width=\"30\" height=\"30\"> Invia con un SMS</a>\r\n      <a class=\"btn btn-secondary\" href=\"#\" role=\"button\"><img :src=\"publicPath + 'WhatsApp.svg'\" alt=\"whatsapp icon\" width=\"30\" height=\"30\"> Invia con WhatsApp</a>\r\n      <a class=\"btn btn-secondary\" href=\"#\" role=\"button\"><img src=\"~bootstrap-icons/icons/envelope.svg\" alt=\"email icon\" width=\"30\" height=\"30\"> Invia tramite E-mail</a>\r\n    </div>\r\n    <hr>\r\n    <video id=\"localVideo\" autoplay muted playsinline class=\"mx-auto\"></video>\r\n    <button type=\"button\" class=\"btn btn-secondary btn-lg w-100 mt-3 mb-3\" v-on:click=\"hangup\" :disabled=\"!$parent.live_streaming\">Termina il live-streaming</button>\r\n    <button type=\"button\" class=\"btn btn-secondary btn-lg w-100 mt-3 mb-3\">Proposta di acquisto</button>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport 'webrtc-adapter'\r\nimport io from 'socket.io-client'\r\n\r\nvar pcConfig = {\r\n  'iceServers': [{\r\n    'urls': 'stun:stun.l.google.com:19302'\r\n  },\r\n  {\r\n    'urls': 'turn:zuly.it:3478',\r\n    'credential': 'test1',\r\n    'username': 'test1'\r\n  }]\r\n}\r\n\r\nexport default {\r\n  data () {\r\n    return {\r\n      publicPath: process.env.BASE_URL,\r\n      store_id: null,\r\n      contact_id: '',\r\n      name: 'Paolo Greppi'\r\n    }\r\n  },\r\n  methods: {\r\n    sendMessage: function (message) {\r\n      console.log('Client sending message: ', message)\r\n      this.$parent.socket.emit('message', message)\r\n    },\r\n    gotStream: function (stream) {\r\n      console.log('Adding local stream.')\r\n      this.$parent.localStream = stream\r\n      var localVideo = document.querySelector('#localVideo')\r\n      localVideo.srcObject = stream\r\n      this.$parent.live_streaming = window.location.pathname\r\n    },\r\n    maybeStart: function () {\r\n      console.log('>>>>>>> maybeStart() ', this.$parent.isStarted, this.$parent.localStream, this.$parent.isChannelReady)\r\n      if (typeof this.$parent.localStream !== 'undefined' && this.$parent.isChannelReady) {\r\n        console.log('>>>>>> creating peer connection')\r\n        this.createPeerConnection()\r\n        this.$parent.peerConnection.addStream(this.$parent.localStream)\r\n        this.$parent.isStarted = true\r\n        this.doCall()\r\n      }\r\n    },\r\n    createPeerConnection: function () {\r\n      try {\r\n        this.$parent.peerConnection = new RTCPeerConnection(pcConfig)\r\n        this.$parent.peerConnection.onicecandidate = this.handleIceCandidate\r\n        this.$parent.peerConnection.onremovestream = this.handleRemoteStreamRemoved\r\n        console.log('Created RTCPeerConnnection')\r\n      } catch (e) {\r\n        console.log('Failed to create PeerConnection, exception: ' + e.message)\r\n        alert('Cannot create RTCPeerConnection object.')\r\n      }\r\n    },\r\n    handleIceCandidate: function (event) {\r\n      console.log('icecandidate event: ', event)\r\n      if (event.candidate) {\r\n        this.sendMessage({\r\n          type: 'candidate',\r\n          label: event.candidate.sdpMLineIndex,\r\n          id: event.candidate.sdpMid,\r\n          candidate: event.candidate.candidate\r\n        })\r\n      } else {\r\n        console.log('End of candidates.')\r\n      }\r\n    },\r\n    handleCreateOfferError: function (event) {\r\n      console.log('createOffer() error: ', event)\r\n    },\r\n    doCall: function () {\r\n      console.log('Sending offer to peer')\r\n      this.$parent.peerConnection.createOffer(this.setLocalAndSendMessage, this.handleCreateOfferError)\r\n    },\r\n    setLocalAndSendMessage: function (sessionDescription) {\r\n      this.$parent.peerConnection.setLocalDescription(sessionDescription)\r\n      console.log('setLocalAndSendMessage sending message', sessionDescription)\r\n      this.sendMessage(sessionDescription)\r\n    },\r\n    handleRemoteStreamRemoved: function (event) {\r\n      console.log('Remote stream removed. Event: ', event)\r\n    },\r\n    hangup: function () {\r\n      console.log('Hanging up.')\r\n      this.stop()\r\n      if ('getTracks' in this.$parent.localStream) {\r\n        this.$parent.localStream.getTracks().forEach(function (track) {\r\n          if (track.readyState === 'live') {\r\n            track.stop()\r\n          }\r\n        })\r\n      }\r\n      this.$parent.socket.emit('close', this.contact_id)\r\n    },\r\n    handleRemoteHangup: function () {\r\n      console.log('Session terminated.')\r\n      this.stop()\r\n    },\r\n    stop: function () {\r\n      this.$parent.live_streaming = ''\r\n      this.$parent.isStarted = false\r\n      if (this.$parent.peerConnection) {\r\n        this.$parent.peerConnection.close()\r\n        this.$parent.peerConnection = null\r\n      }\r\n    }\r\n  },\r\n  created: function () {\r\n    console.log('Live created')\r\n  },\r\n  mounted: function () {\r\n    console.log('Live mounted')\r\n\r\n    this.store_id = this.$route.params.id\r\n    this.contact_id = this.$route.params.contact_id\r\n\r\n    this.$parent.socket = io.connect()\r\n\r\n    this.$parent.socket.on('opened', (room) => {\r\n      console.log('Opened room ' + room)\r\n    })\r\n\r\n    this.$parent.socket.on('full', (room) => {\r\n      console.log('Room ' + room + ' is full')\r\n    })\r\n\r\n    this.$parent.socket.on('join', (room) => {\r\n      console.log('Another peer made a request to join room ' + room)\r\n      console.log('This peer is the initiator of room ' + room + '!')\r\n      this.$parent.isChannelReady = true\r\n    })\r\n\r\n    this.$parent.socket.on('joined', (room) => {\r\n      console.log('joined: ' + room)\r\n      this.$parent.isChannelReady = true\r\n    })\r\n\r\n    this.$parent.socket.on('log', (array) => {\r\n      console.log.apply(console, array)\r\n    })\r\n\r\n    // This client receives a message\r\n    this.$parent.socket.on('message', (message) => {\r\n      console.log('Client received message:', message)\r\n      if (message === 'got user media') {\r\n        this.maybeStart()\r\n      } else if (message.type === 'answer' && this.$parent.isStarted) {\r\n        this.$parent.peerConnection.setRemoteDescription(new RTCSessionDescription(message))\r\n      } else if (message.type === 'candidate' && this.$parent.isStarted) {\r\n        var candidate = new RTCIceCandidate({\r\n          sdpMLineIndex: message.label,\r\n          candidate: message.candidate\r\n        })\r\n        this.$parent.peerConnection.addIceCandidate(candidate)\r\n      } else if (message === 'bye' && this.$parent.isStarted) {\r\n        this.handleRemoteHangup()\r\n      }\r\n    })\r\n\r\n    window.onbeforeunload = () => {\r\n      this.sendMessage('bye')\r\n      return null\r\n    }\r\n\r\n    if (this.$parent.live_streaming) {\r\n      var localVideo = document.querySelector('#localVideo')\r\n      localVideo.srcObject = this.$parent.localStream\r\n    } else {\r\n      if (this.contact_id !== '') {\r\n        this.$parent.socket.emit('open', this.contact_id)\r\n        console.log('Attempted to open room: ', this.contact_id)\r\n      }\r\n      // window.navigator.mediaDevices.getUserMedia({\r\n      //   audio: false,\r\n      //   video: true\r\n      // })\r\n      //   .then(this.gotStream)\r\n      //   .catch(function (e) {\r\n      //     alert('getUserMedia() error: ' + e.name)\r\n      //   })\r\n    }\r\n  }\r\n}\r\n\r\n</script>\n"]}]}